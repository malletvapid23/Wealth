!function(){"use strict";function e(e){e=e.forSource("mainRun")}angular.module("main",["ngRoute","ngSanitize","breeze.angular","angular-google-analytics","angularUtils.directives.dirDisqus","ui.bootstrap","highcharts-ng"]),angular.module("main").run(["logger",e])}(),function(){"use strict";function e(e){e.interceptors.push(r)}function t(e,t){t=t.forSource("authorizationRun");var n=e.OData.defaultHttpClient,r={request:function(t,r,l){t.headers=t.headers||{};var o=angular.fromJson(e.localStorage.getItem("token"));return t.headers.Authorization=null!==o?"Bearer "+o.access_token:"",n.request(t,r,l)}};e.OData.defaultHttpClient=r}function n(e,t,n){return n=n.forSource(r),{request:function(e){e.headers=e.headers||{};var n=angular.fromJson(t.localStorage.getItem("token"));return e.headers.Authorization=null!==n?"Bearer "+n.access_token:"",e},response:function(t){return 401===t.status,t||e.when(t)}}}angular.module("main").config(["$httpProvider",e]),angular.module("main").run(["$window","logger",t]);var r="angularInterceptor";angular.module("main").factory(r,["$q","$window","logger",n])}(),function(){"use strict";function e(e){function t(e){var t=null;"object"==typeof document?(t=document.createElement("a"),t.href=e.serviceName):t=url.parse(e.serviceName);var n=t.pathname;return"/"!==n[0]&&(n="/"+n),"/"!==n.substr(-1)&&(n+="/"),n}breeze.config.initializeAdapterInstance("uriBuilder","odata");var n=breeze.config.initializeAdapterInstance("dataService","webApiOData",!0);n.getRoutePrefix=t}angular.module("main").config(["breezeProvider",e])}(),function(){"use strict";function e(e){e.decorator("$exceptionHandler",["$delegate","$injector","$window","serviceAppUrl","logger",t])}function t(e,t,r,l,o){function i(e){function n(e){if(a[e])return a[e];var t=o.get(e).then(function(t){var n=t.data.match(/\/\/# sourceMappingURL=(.+\.map)/);if(n){var r=e.match(/^(.+)\/[^/]+$/);return r=r&&r[1],o.get(r+"/"+n[1]).then(function(e){return new i(e.data)})}return l.reject()});return a[e]=t,t}var l=t.get("$q"),o=t.get("$http"),i=r.sourceMap.SourceMapConsumer,a={};return e.stack?l.all($.map(e.stack.split(/\n/),function(e){var t=e.match(/^(.+)(http.+):(\d+):(\d+)/);if(t){var o=t[1],i=t[2],a=t[3],u=t[4];return n(i).then(function(e){var t=e.originalPositionFor({line:parseInt(a,10),column:parseInt(u,10)}),n=o.match(/\s*(at)?\s*(.*?)\s*(\(|@)/);return n=n&&n[2]||"","    at "+(t.name?t.name:n)+" "+r.location.origin+t.source+":"+t.line+":"+t.column},function(){return e})}return l.when(e)})).then(function(e){return e.join("\n")}):l.when("")}o=o.forSource(n);var a=l+"/api/Exception/Record";return function(e,n){o.logError("Something went wrong, please try again later!",null,!0),i(e).then(function(r){var l=t.get("$location"),o=t.get("$http"),i={Message:e.message,Cause:n,Url:l.url(),Stack:r};o.post(a,i),setTimeout(function(){throw e})})}}var n="exceptionHandlerExtension";angular.module("main").config(["$provide",e])}(),function(){"use strict";function e(e,t,n){e.setAccount(t).setDomainName(n).ignoreFirstPageLoad(!0)}angular.module("main").config(["AnalyticsProvider","analyticsTrackingCode","analyticsDomainName",e]),angular.module("main").run(["Analytics",function(e){}])}(),function(){"use strict";function e(e,t){function n(e){var t="undefined"!=typeof e.key?e.key[0]+e.key.substring(1):"Home";return t}function r(e){var t="undefined"!=typeof e.key?e.key:"home";return"/_system/views/content/"+t+".html?v=0.49.0"}function l(e,t,n,r,l,o){o=o.forSource("validateAccess");var i=n.defer();return r.createItem(l,t.current).then(function(){e.getCurrentUser().then(function(e){"undefined"!==t.current.accessType&&("unauthenticatedRequired"===t.current.accessType&&e.isAuthenticated()||"authenticatedRequired"===t.current.accessType&&!e.isAuthenticated())&&i.reject({accessType:t.current.accessType}),i.resolve()})["catch"](function(){i.reject()})}),i.promise}e.when("/",{title:n,templateUrl:r,enableDisqus:!0,resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/default.aspx",{title:n,templateUrl:r,enableDisqus:!0,resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/content/404/",{title:function(){return"404"},templateUrl:"/_system/views/content/404.html?v=0.49.0",enableDisqus:!1,resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/content/:key/",{title:n,templateUrl:r,enableDisqus:!0,resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/resourcePool",{title:function(){return"CMRP List"},templateUrl:"/_system/views/resourcePool/resourcePoolList.html?v=0.49.1",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/resourcePool/new",{title:function(){return"New CMRP"},templateUrl:"/_system/views/resourcePool/resourcePoolManage.html?v=0.49.0",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/resourcePool/:resourcePoolId/edit",{title:function(){return"Edit CMRP"},templateUrl:"/_system/views/resourcePool/resourcePoolManage.html?v=0.49.0",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/resourcePool/:resourcePoolId",{title:function(){return"View CMRP"},templateUrl:"/_system/views/resourcePool/resourcePoolView.html?v=0.49.0",enableDisqus:!0,resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/accountEdit",{title:function(){return"Account Edit"},templateUrl:"/_system/views/account/accountEdit.html?v=0.49.0",accessType:"authenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/addPassword",{title:function(){return"Add Password"},templateUrl:"/_system/views/account/addPassword.html?v=0.49.0",accessType:"authenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/changeEmail",{title:function(){return"Change Email"},templateUrl:"/_system/views/account/changeEmail.html?v=0.49.0",accessType:"authenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/changePassword",{title:function(){return"Change Password"},templateUrl:"/_system/views/account/changePassword.html?v=0.49.0",accessType:"authenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/confirmEmail",{title:function(){return"Confirm Email"},templateUrl:"/_system/views/account/confirmEmail.html?v=0.49.0",accessType:"authenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/login",{title:function(){return"Login"},templateUrl:"/_system/views/account/login.html?v=0.49.0",accessType:"unauthenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/register",{title:function(){return"Register"},templateUrl:"/_system/views/account/register.html?v=0.49.0",accessType:"unauthenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).when("/_system/account/resetPassword",{title:function(){return"Reset Password"},templateUrl:"/_system/views/account/resetPassword.html?v=0.49.0",accessType:"unauthenticatedRequired",resolve:{validateAccess:["userFactory","$route","$q","locationHistory","$location","logger",l]}}).otherwise({redirectTo:"/_system/content/404"}),window.history&&window.history.pushState&&t.html5Mode({enabled:!0})}function t(e,t,n,r){function l(e,r,l,o){"unauthenticatedRequired"===o.accessType?t.url(n.previousItem("unauthenticatedRequired").url()):"authenticatedRequired"===o.accessType&&t.url("/_system/account/login?error=To be able to continue, please login first")}function o(t,n,r){var l="";"undefined"!=typeof n.title&&(l=n.title(n.params)),e.viewTitle=l}r=r.forSource("routeRun"),e.$on("$routeChangeSuccess",o),e.$on("$routeChangeError",l)}angular.module("main").config(["$routeProvider","$locationProvider",e]),angular.module("main").run(["$rootScope","$location","locationHistory","logger",t])}(),function(){"use strict";function e(e,n){function r(){function e(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.directIncome()}),e}function t(){return null===F.backingFields._directIncomeField&&F.setDirectIncomeField(),F.backingFields._directIncomeField}function n(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.directIncomeIncludingResourcePoolAmount()}),e}function r(){return null===F.backingFields._elementFieldIndexSet&&F.setElementFieldIndexSet(),F.backingFields._elementFieldIndexSet}function l(){return null===F.backingFields._familyTree&&F.setFamilyTree(),F.backingFields._familyTree}function o(){return F.ElementFieldSet.length>4||F.elementFieldIndexSet().length>2}function i(e){var t=e.ElementFieldSet.sort(function(e,t){return e.SortOrder-t.SortOrder}),n=[];return t.forEach(function(e){if(e.IndexEnabled&&n.push(e),6===e.DataType&&null!==e.SelectedElement){var t=i(e.SelectedElement);t.forEach(function(e){n.push(e)})}}),n}function a(){return null===F.backingFields._indexRating&&F.setIndexRating(!1),F.backingFields._indexRating}function u(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.multiplier()}),e}function c(){return null!==F.backingFields._multiplierField&&F.setMultiplierField(),F.backingFields._multiplierField}function s(){return null===F.backingFields._parent&&F.setParent(),F.backingFields._parent}function d(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.resourcePoolAmount()}),e}function m(){var e=F.ElementFieldSet.filter(function(e){return 11===e.DataType});e.length>0&&(F.backingFields._directIncomeField=e[0])}function f(){F.backingFields._elementFieldIndexSet=i(F)}function g(){F.backingFields._familyTree=[];for(var e=F;null!==e;)F.backingFields._familyTree.unshift(e),e=e.parent()}function E(e){e="undefined"==typeof e?!0:e;var t=F.elementFieldIndexSet(),n=0;t.forEach(function(e){n+=e.indexRating()}),F.backingFields._indexRating!==n&&(F.backingFields._indexRating=n,e&&F.elementFieldIndexSet().forEach(function(e){e.setIndexRatingPercentage()}))}function h(){var e=F.ElementFieldSet.filter(function(e){return 12===e.DataType});e.length>0&&(F.backingFields._multiplierField=e[0])}function p(){F.ParentFieldSet.length>0&&(F.backingFields._parent=F.ParentFieldSet[0].Element)}function y(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.totalDirectIncome()}),e}function R(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.totalDirectIncomeIncludingResourcePoolAmount()}),e}function P(){var e=0;return F.ElementItemSet.forEach(function(t){e+=t.totalIncome()}),e}function v(){return 0===F.ElementItemSet.length?0:F.totalIncome()/F.ElementItemSet.length}function C(){var e;return F===F.ResourcePool.mainElement()?(e=F.ResourcePool.InitialValue,F.ElementItemSet.forEach(function(t){e+=t.totalResourcePoolAmount()})):null!==F.ResourcePool.mainElement()&&(e=F.ResourcePool.mainElement().totalResourcePoolAmount()),F.backingFields._totalResourcePoolAmount!==e&&(F.backingFields._totalResourcePoolAmount=e,F.elementFieldIndexSet().forEach(function(e){e.setIndexIncome()})),e}var F=this;F.Id=0,F.Name="",F.backingFields={_IsMainElement:!1,_parent:null,_familyTree:null,_elementFieldIndexSet:null,_indexRating:null,_directIncomeField:null,_multiplierField:null,_totalResourcePoolAmount:null},F.isEditing=!1,F.directIncome=e,F.directIncomeField=t,F.directIncomeIncludingResourcePoolAmount=n,F.elementFieldIndexSet=r,F.familyTree=l,F.fullSize=o,F.indexRating=a,F.multiplier=u,F.multiplierField=c,F.parent=s,F.resourcePoolAmount=d,F.setDirectIncomeField=m,F.setElementFieldIndexSet=f,F.setFamilyTree=g,F.setIndexRating=E,F.setMultiplierField=h,F.setParent=p,F.totalDirectIncome=y,F.totalDirectIncomeIncludingResourcePoolAmount=R,F.totalIncome=P,F.totalIncomeAverage=v,F.totalResourcePoolAmount=C}return n=n.forSource(t),Object.defineProperty(r.prototype,"IsMainElement",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._IsMainElement},set:function(e){var t=this;if(t.backingFields._IsMainElement!==e){if(t.backingFields._IsMainElement=e,"undefined"==typeof t.ResoucePool)return;e&&(t.ResourcePool.ElementSet.forEach(function(e){e!==t&&e.IsMainElement&&(e.IsMainElement=!1)}),t.ResourcePool.selectedElement(t))}}}),r}var t="Element";angular.module("main").factory(t,["$rootScope","logger",e])}(),function(){"use strict";function e(e){function n(){function e(){return null===U.backingFields._aggressiveRating&&U.setAggressiveRating(!1),U.backingFields._aggressiveRating}function t(){return U.UserElementCellSet.length>0?U.UserElementCellSet[0]:null}function n(){return null===U.backingFields._currentUserNumericValue&&U.setCurrentUserNumericValue(!1),U.backingFields._currentUserNumericValue}function r(){return U.setIndexIncome(),U.backingFields._indexIncome}function l(){return null===U.backingFields._numericValue&&U.setNumericValue(!1),U.backingFields._numericValue}function o(){return null===U.numericValueCount()?null:0===U.numericValueCount()?0:U.numericValueTotal()/U.numericValueCount()}function i(){return U.ElementField.UseFixedValue?null!==U.currentUserCell()&&U.currentUserCell().UserId===U.ElementField.Element.ResourcePool.UserId?1:U.otherUsersNumericValueCount():U.otherUsersNumericValueCount()+1}function a(){return null===U.backingFields._numericValueMultiplied&&U.setNumericValueMultiplied(!1),U.backingFields._numericValueMultiplied}function u(){return null===U.backingFields._numericValueMultipliedPercentage&&U.setNumericValueMultipliedPercentage(!1),U.backingFields._numericValueMultipliedPercentage}function c(){return U.ElementField.UseFixedValue?null!==U.currentUserCell()&&U.currentUserCell().UserId===U.ElementField.Element.ResourcePool.UserId?U.currentUserNumericValue():U.otherUsersNumericValueTotal():U.otherUsersNumericValueTotal()+U.currentUserNumericValue()}function s(){return null===U.backingFields._otherUsersNumericValueCount&&U.setOtherUsersNumericValueCount(),U.backingFields._otherUsersNumericValueCount}function d(){return null===U.backingFields._otherUsersNumericValueTotal&&U.setOtherUsersNumericValueTotal(),U.backingFields._otherUsersNumericValueTotal}function m(){return null===U.backingFields._passiveRating&&U.setPassiveRating(!1),U.backingFields._passiveRating}function f(){return null===U.backingFields._rating&&U.setRating(!1),U.backingFields._rating}function g(){return null===U.backingFields._ratingPercentage&&U.setRatingPercentage(!1),U.backingFields._ratingPercentage}function E(e){e="undefined"==typeof e?!0:e;var t=0;if(U.ElementField.IndexEnabled&&U.ElementField.referenceRatingMultiplied()>0){switch(U.ElementField.IndexSortType){case 1:t=(1-U.numericValueMultipliedPercentage())/U.ElementField.referenceRatingMultiplied();break;case 2:t=U.numericValueMultiplied()/U.ElementField.referenceRatingMultiplied()}U.ElementField.referenceRatingAllEqualFlag()||(t=1-t)}U.backingFields._aggressiveRating!==t&&(U.backingFields._aggressiveRating=t)}function h(e){e="undefined"==typeof e?!0:e;var t,n=U.currentUserCell();switch(U.ElementField.DataType){case 2:t=null!==n?n.BooleanValue:0;break;case 3:t=null!==n?n.IntegerValue:0;break;case 4:t=null!==n?n.DecimalValue:50;break;case 11:t=null!==U.NumericValueTotal?U.NumericValueTotal:0;break;case 12:t=null!==n?n.DecimalValue:0}U.backingFields._currentUserNumericValue!==t&&(U.backingFields._currentUserNumericValue=t,e&&U.setNumericValue())}function p(e){e="undefined"==typeof e?!0:e;var t=0;6===U.ElementField.DataType&&null!==U.SelectedElementItem?t=U.SelectedElementItem.totalResourcePoolIncome()/U.SelectedElementItem.ParentCellSet.length:U.ElementField.IndexEnabled&&(t=U.ElementField.indexIncome()*U.ratingPercentage()),U.backingFields._indexIncome!==t&&(U.backingFields._indexIncome=t)}function y(e){e="undefined"==typeof e?!0:e;var t;if("undefined"!=typeof U.ElementField)switch(U.ElementField.Element.ResourcePool.RatingMode){case 1:t=U.currentUserNumericValue();break;case 2:t=U.numericValueAverage()}U.backingFields._numericValue!==t&&(U.backingFields._numericValue=t,e&&(11===U.ElementField.DataType&&U.ElementItem.setDirectIncome(),U.setNumericValueMultiplied()))}function R(e){e="undefined"==typeof e?!0:e;var t;t="undefined"==typeof U.ElementField?0:U.numericValue()*U.ElementItem.multiplier(),U.backingFields._numericValueMultiplied!==t&&(U.backingFields._numericValueMultiplied=t,e&&U.ElementField.setNumericValueMultiplied())}function P(e){e="undefined"==typeof e?!0:e;var t=0;U.ElementField.IndexEnabled&&U.ElementField.numericValueMultiplied()>0&&(t=U.numericValueMultiplied()/U.ElementField.numericValueMultiplied()),U.backingFields._numericValueMultipliedPercentage!==t&&(U.backingFields._numericValueMultipliedPercentage=t)}function v(){U.backingFields._otherUsersNumericValueCount=U.NumericValueCount,U.UserElementCellSet.length>0&&U.backingFields._otherUsersNumericValueCount--}function C(){if(U.backingFields._otherUsersNumericValueTotal=null!==U.NumericValueTotal?U.NumericValueTotal:0,U.UserElementCellSet.length>0){var e=0;switch(U.ElementField.DataType){case 2:e=U.UserElementCellSet[0].BooleanValue;break;case 3:e=U.UserElementCellSet[0].IntegerValue;break;case 4:e=U.UserElementCellSet[0].DecimalValue;break;case 11:e=U.UserElementCellSet[0].DecimalValue}U.backingFields._otherUsersNumericValueTotal-=e}}function F(e){e="undefined"==typeof e?!0:e;var t=0;if(U.ElementField.IndexEnabled)switch(U.ElementField.IndexSortType){case 1:t=U.numericValueMultipliedPercentage();break;case 2:U.ElementField.passiveRating()>0&&(t=(1-U.numericValueMultipliedPercentage())/U.ElementField.passiveRating())}U.backingFields._passiveRating!==t&&(U.backingFields._passiveRating=t)}function I(e){e="undefined"==typeof e?!0:e;var t=0;if(1===U.ElementField.ElementCellSet.length)t=1;else switch(U.ElementField.IndexCalculationType){case 1:t=U.aggressiveRating();break;case 2:t=U.passiveRating()}U.backingFields._rating!==t&&(U.backingFields._rating=t)}function S(e){e="undefined"==typeof e?!0:e;var t=0;U.ElementField.IndexEnabled&&U.ElementField.rating()>0&&(t=U.rating()/U.ElementField.rating()),U.backingFields._ratingPercentage!==t&&(U.backingFields._ratingPercentage=t)}function b(){var e=null;switch(U.ElementField.DataType){case 1:U.UserElementCellSet.length>0&&(e=U.UserElementCellSet[0].StringValue);break;case 2:U.UserElementCellSet.length>0&&(e=U.UserElementCellSet[0].BooleanValue?"True":"False");break;case 3:U.UserElementCellSet.length>0&&(e=U.UserElementCellSet[0].IntegerValue);break;case 4:case 11:case 12:U.UserElementCellSet.length>0&&(e=U.UserElementCellSet[0].DecimalValue);break;case 6:null!==U.SelectedElementItem&&(e=U.SelectedElementItem.Name)}return e}var U=this;U.Id=0,U.ElementFieldId=0,U.ElementItemId=0,U.StringValue="",U.NumericValueTotal=0,U.NumericValueCount=0,U.SelectedElementItemId=null,U.backingFields={_currentUserNumericValue:null,_otherUsersNumericValueTotal:null,_otherUsersNumericValueCount:null,_numericValue:null,_numericValueMultiplied:null,_numericValueMultipliedPercentage:null,_passiveRating:null,_aggressiveRating:null,_rating:null,_ratingPercentage:null,_indexIncome:null},U.isEditing=!1,U.aggressiveRating=e,U.currentUserCell=t,U.currentUserNumericValue=n,U.indexIncome=r,U.numericValue=l,U.numericValueAverage=o,U.numericValueCount=i,U.numericValueMultiplied=a,U.numericValueMultipliedPercentage=u,U.numericValueTotal=c,U.otherUsersNumericValueCount=s,U.otherUsersNumericValueTotal=d,U.passiveRating=m,U.rating=f,U.ratingPercentage=g,U.setAggressiveRating=E,U.setCurrentUserNumericValue=h,U.setIndexIncome=p,U.setNumericValue=y,U.setNumericValueMultiplied=R,U.setNumericValueMultipliedPercentage=P,U.setOtherUsersNumericValueCount=v,U.setOtherUsersNumericValueTotal=C,U.setPassiveRating=F,U.setRating=I,U.setRatingPercentage=S,U.value=b}return e=e.forSource(t),n}var t="ElementCell";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e,n){function r(){function e(){return b.UserElementFieldSet.length>0?b.UserElementFieldSet[0]:null}function t(){return null===b.backingFields._currentUserIndexRating&&b.setCurrentUserIndexRating(!1),b.backingFields._currentUserIndexRating}function n(){return null===b.backingFields._indexIncome&&b.setIndexIncome(!1),b.backingFields._indexIncome}function r(){return null===b.backingFields._indexRating&&b.setIndexRating(!1),b.backingFields._indexRating}function l(){return null===b.indexRatingCount()?null:0===b.indexRatingCount()?0:b.indexRatingTotal()/b.indexRatingCount()}function o(){return b.otherUsersIndexRatingCount()+1}function i(){return null===b.backingFields._indexRatingPercentage&&b.setIndexRatingPercentage(!1),b.backingFields._indexRatingPercentage}function a(){return b.otherUsersIndexRatingTotal()+b.currentUserIndexRating()}function u(){return null===b.backingFields._numericValueMultiplied&&b.setNumericValueMultiplied(!1),b.backingFields._numericValueMultiplied}function c(){return null===b.backingFields._otherUsersIndexRatingCount&&b.setOtherUsersIndexRatingCount(),b.backingFields._otherUsersIndexRatingCount}function s(){return null===b.backingFields._otherUsersIndexRatingTotal&&b.setOtherUsersIndexRatingTotal(),b.backingFields._otherUsersIndexRatingTotal}function d(){return null===b.backingFields._passiveRating&&b.setPassiveRating(!1),b.backingFields._passiveRating}function m(){return null===b.backingFields._rating&&b.setRating(!1),b.backingFields._rating}function f(e){return b.backingFields._referenceRatingAllEqualFlag}function g(){return null===b.backingFields._referenceRatingMultiplied&&b.setReferenceRatingMultiplied(!1),b.backingFields._referenceRatingMultiplied}function E(e){e="undefined"==typeof e?!0:e;var t=null!==b.currentUserElementField()?b.currentUserElementField().Rating:50;b.backingFields._currentUserIndexRating!==t&&(b.backingFields._currentUserIndexRating=t,e&&b.setIndexRating())}function h(e){e="undefined"==typeof e?!0:e;var t=b.Element.totalResourcePoolAmount()*b.indexRatingPercentage();b.backingFields._indexIncome!==t&&(b.backingFields._indexIncome=t,e&&b.ElementCellSet.forEach(function(e){e.setIndexIncome()}))}function p(e){e="undefined"==typeof e?!0:e;var t=0;switch(b.Element.ResourcePool.RatingMode){case 1:t=b.currentUserIndexRating();break;case 2:t=b.indexRatingAverage()}b.backingFields._indexRating!==t&&(b.backingFields._indexRating=t,e&&b.Element.ResourcePool.mainElement().setIndexRating())}function y(e){e="undefined"==typeof e?!0:e;var t=0,n=b.Element.ResourcePool.mainElement().indexRating();t=0===n?0:b.indexRating()/n,b.backingFields._indexRatingPercentage!==t&&(b.backingFields._indexRatingPercentage=t,e&&b.setIndexIncome())}function R(e){e="undefined"==typeof e?!0:e;var t=0;0===b.ElementCellSet.length?t=0:b.ElementCellSet.forEach(function(e){t+=e.numericValueMultiplied()}),b.backingFields._numericValueMultiplied!==t&&(b.backingFields._numericValueMultiplied=t,e&&b.IndexEnabled&&(b.ElementCellSet.forEach(function(e){e.setNumericValueMultipliedPercentage(!1)}),b.setPassiveRating(!1),b.ElementCellSet.forEach(function(e){e.setPassiveRating(!1)}),b.setReferenceRatingMultiplied(!1),b.ElementCellSet.forEach(function(e){e.setAggressiveRating(!1)}),b.ElementCellSet.forEach(function(e){e.setRating(!1)}),b.setRating(!1),b.ElementCellSet.forEach(function(e){e.setRatingPercentage(!1)}),b.ElementCellSet.forEach(function(e){e.setIndexIncome(!1)})))}function P(){b.backingFields._otherUsersIndexRatingCount=b.IndexRatingCount,null!==b.currentUserElementField()&&b.backingFields._otherUsersIndexRatingCount--}function v(){b.backingFields._otherUsersIndexRatingTotal=null!==b.IndexRatingTotal?b.IndexRatingTotal:0,null!==b.currentUserElementField()&&(b.backingFields._otherUsersIndexRatingTotal-=b.currentUserElementField().Rating)}function C(e){e="undefined"==typeof e?!0:e;var t=0;b.ElementCellSet.forEach(function(e){t+=1-e.numericValueMultipliedPercentage()}),b.backingFields._passiveRating!==t&&(b.backingFields._passiveRating=t)}function F(e){e="undefined"==typeof e?!0:e;var t=0;b.ElementCellSet.forEach(function(e){t+=e.rating()}),b.backingFields._rating!==t&&(b.backingFields._rating=t,e&&(b.ElementCellSet.forEach(function(e){e.setRatingPercentage(!1)}),b.setIndexIncome()))}function I(e){return b.backingFields._referenceRatingAllEqualFlag!==e?(b.backingFields._referenceRatingAllEqualFlag=e,!0):!1}function S(e){e="undefined"==typeof e?!0:e;var t=null,n=!0;0===b.ElementCellSet.length?t=0:b.ElementCellSet.forEach(function(e){if(null===t)switch(b.IndexSortType){case 1:t=1-e.numericValueMultipliedPercentage();break;case 2:t=e.numericValueMultiplied()}else switch(b.IndexSortType){case 1:1-e.numericValueMultipliedPercentage()!==t&&(n=!1),1-e.numericValueMultipliedPercentage()>t&&(t=1-e.numericValueMultipliedPercentage());break;case 2:e.numericValueMultiplied()!==t&&(n=!1),e.numericValueMultiplied()>t&&(t=e.numericValueMultiplied())}});var r=b.setReferenceRatingAllEqualFlag(n),l=!1;b.backingFields._referenceRatingMultiplied!==t&&(b.backingFields._referenceRatingMultiplied=t,l=!0),(r||l)&&e&&b.ElementCellSet.forEach(function(e){e.setAggressiveRating(!1)})}var b=this;b.Id=0,b.ElementId=0,b.Name="",b.SelectedElementId=null,b.UseFixedValue=null,b.IndexCalculationType=0,b.IndexSortType=0,b.SortOrder=0,b.IndexRatingTotal=0,b.IndexRatingCount=0,b.backingFields={_dataType:1,_indexEnabled:!1,_currentUserIndexRating:null,_otherUsersIndexRatingTotal:null,_otherUsersIndexRatingCount:null,_indexRating:null,_indexRatingPercentage:null,_numericValueMultiplied:null,_passiveRating:null,_referenceRatingMultiplied:null,_referenceRatingAllEqualFlag:!0,_aggressiveRating:null,_rating:null,_indexIncome:null},b.isEditing=!1,b.currentUserElementField=e,b.currentUserIndexRating=t,b.indexIncome=n,b.indexRating=r,b.indexRatingAverage=l,b.indexRatingCount=o,b.indexRatingPercentage=i,b.indexRatingTotal=a,b.numericValueMultiplied=u,b.otherUsersIndexRatingCount=c,b.otherUsersIndexRatingTotal=s,b.passiveRating=d,b.rating=m,b.referenceRatingAllEqualFlag=f,b.referenceRatingMultiplied=g,b.setCurrentUserIndexRating=E,b.setIndexIncome=h,b.setIndexRating=p,b.setIndexRatingPercentage=y,b.setNumericValueMultiplied=R,b.setOtherUsersIndexRatingCount=P,b.setOtherUsersIndexRatingTotal=v,b.setPassiveRating=C,b.setRating=F,b.setReferenceRatingAllEqualFlag=I,b.setReferenceRatingMultiplied=S}return n=n.forSource(t),Object.defineProperty(r.prototype,"DataType",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._dataType},set:function(t){var n=this;n.backingFields._dataType!==t&&(n.ElementCellSet.forEach(function(r){r.SelectedElementItemId=null;var l=r.UserElementCellSet.slice();if(l.forEach(function(e){e.entityAspect.setDetached()}),6!==t){var o=r.currentUserCell(),i=null===o;switch(i&&(o={User:n.Element.ResourcePool.User,ElementCell:r}),t){case 1:o.StringValue="";break;case 2:o.BooleanValue=!1;break;case 3:o.IntegerValue=0;break;case 4:o.DecimalValue=50;break;case 11:o.DecimalValue=100;break;case 12:o.DecimalValue=0}i&&e.$broadcast("ElementField_createUserElementCell",o)}}),n.backingFields._dataType=t)}}),Object.defineProperty(r.prototype,"IndexEnabled",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._indexEnabled},set:function(e){this.backingFields._indexEnabled!==e&&(this.backingFields._indexEnabled=e,this.IndexCalculationType=e?1:0,this.IndexSortType=e?1:0)}}),r}var t="ElementField";angular.module("main").factory(t,["$rootScope","logger",e])}(),function(){"use strict";function e(e){function n(){function e(){return null===y.backingFields._directIncome&&y.setDirectIncome(!1),y.backingFields._directIncome}function t(){return y.directIncome()+y.resourcePoolAmount()}function n(){return null===y.backingFields._elementCellIndexSet&&y.setElementCellIndexSet(),y.backingFields._elementCellIndexSet}function r(e){var t=[],n=e.ElementCellSet.sort(function(e,t){return e.ElementField.SortOrder-t.ElementField.SortOrder});return n.forEach(function(e){if(e.ElementField.IndexEnabled&&t.push(e),6===e.ElementField.DataType&&null!==e.SelectedElementItem){var n=r(e.SelectedElementItem);n.length>0&&t.push(e)}}),t}function l(){var e=y.totalIncome(),t=Number(y.Element.totalIncomeAverage().toFixed(2));return e===t?"average":t>e?"low":e>t?"high":void 0}function o(){return null===y.backingFields._multiplier&&y.setMultiplier(!1),y.backingFields._multiplier}function i(){return null===y.backingFields._resourcePoolAmount&&y.setResourcePoolAmount(!1),y.backingFields._resourcePoolAmount}function a(e){e="undefined"==typeof e?!0:e;var t=null,n=y.ElementCellSet.filter(function(e){return 11===e.ElementField.DataType});n.length>0&&(t=n[0]);var r;r=null===t?0:t.numericValue(),y.backingFields._directIncome!==r&&(y.backingFields._directIncome=r,e&&(y.setTotalDirectIncome(),y.setResourcePoolAmount()))}function u(){y.backingFields._elementCellIndexSet=r(y)}function c(e){e="undefined"==typeof e?!0:e;var t=null,n=y.ElementCellSet.filter(function(e){return 12===e.ElementField.DataType});n.length>0&&(t=n[0]);var r=0;r=null===t?1:null===t.currentUserCell()||null===t.currentUserCell().DecimalValue?0:t.currentUserCell().DecimalValue,y.backingFields._multiplier!==r&&(y.backingFields._multiplier=r,y.setTotalDirectIncome(),y.setTotalResourcePoolAmount())}function s(e){e="undefined"==typeof e?!0:e;var t=y.directIncome()*y.Element.ResourcePool.resourcePoolRatePercentage();y.backingFields._resourcePoolAmount!==t&&(y.backingFields._resourcePoolAmount=t,e&&y.setTotalResourcePoolAmount())}function d(e){e="undefined"==typeof e?!0:e;var t=y.directIncome()*y.multiplier();y.backingFields._totalDirectIncome!==t&&(y.backingFields._totalDirectIncome=t)}function m(e){e="undefined"==typeof e?!0:e;var t=y.resourcePoolAmount()*y.multiplier();y.backingFields._totalResourcePoolAmount!==t&&(y.backingFields._totalResourcePoolAmount=t)}function f(){return null===y.backingFields._totalDirectIncome&&y.setTotalDirectIncome(!1),y.backingFields._totalDirectIncome}function g(){return y.directIncomeIncludingResourcePoolAmount()*y.multiplier()}function E(){var e=y.totalDirectIncome()+y.totalResourcePoolIncome();return Number(e.toFixed(2))}function h(){return null===y.backingFields._totalResourcePoolAmount&&y.setTotalResourcePoolAmount(!1),y.backingFields._totalResourcePoolAmount}function p(){var e=0;return y.ElementCellSet.forEach(function(t){e+=t.indexIncome()}),y.backingFields._totalResourcePoolIncome!==e&&(y.backingFields._totalResourcePoolIncome=e,y.ParentCellSet.forEach(function(e){e.setIndexIncome()})),e}var y=this;y.Id=0,y.ElementId=0,y.Name="",y.backingFields={_elementCellIndexSet:null,_directIncome:null,_multiplier:null,_totalDirectIncome:null,_resourcePoolAmount:null,_totalResourcePoolAmount:null,_totalResourcePoolIncome:null},y.isEditing=!1,y.directIncome=e,y.directIncomeIncludingResourcePoolAmount=t,y.elementCellIndexSet=n,y.incomeStatus=l,y.multiplier=o,y.resourcePoolAmount=i,y.setDirectIncome=a,y.setElementCellIndexSet=u,y.setMultiplier=c,y.setResourcePoolAmount=s,y.setTotalDirectIncome=d,y.setTotalResourcePoolAmount=m,y.totalDirectIncome=f,y.totalDirectIncomeIncludingResourcePoolAmount=g,y.totalIncome=E,y.totalResourcePoolAmount=h,y.totalResourcePoolIncome=p}return e=e.forSource(t),n}var t="ElementItem";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){e=e.forSource(t);var n={};return n.ElementFieldDataType={String:1,Boolean:2,Integer:3,Decimal:4,Element:6,DirectIncome:11,Multiplier:12},n.ElementFieldIndexCalculationType={Aggressive:1,Passive:2},n.ElementFieldIndexSortType={Highest:1,Lowest:2},n.getEnumKey=function(e,t){for(var r in n){if("$get"===e||"getEnumKey"===e)return;if(r===e)for(var l in n[r])if(n[r][l]===t)return l;
}},n}var t="Enums";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){function n(){function e(e){if(e="undefined"!=typeof e?e:!1){var t=[];S.UserResourcePoolSet.forEach(function(e){S.ResourcePoolRateTotal+=e.ResourcePoolRate,S.ResourcePoolRateCount+=1,-1===t.indexOf(e.UserId)&&t.push(e.UserId)}),S.ElementSet.forEach(function(e){e.ElementFieldSet.forEach(function(e){e.UserElementFieldSet.forEach(function(n){e.IndexRatingTotal+=n.IndexRating,e.IndexRatingCount+=1,-1===t.indexOf(n.UserId)&&t.push(n.UserId)}),e.ElementCellSet.forEach(function(n){n.UserElementCellSet.forEach(function(r){n.StringValue="",n.NumericValueTotal+=r.DecimalValue,n.NumericValueCount+=1,e.IndexEnabled&&-1===t.indexOf(r.UserId)&&t.push(r.UserId)})})})}),S.RatingCount=t.length}S.setOtherUsersResourcePoolRateTotal(),S.setOtherUsersResourcePoolRateCount(),"undefined"!=typeof S.ElementSet&&S.ElementSet.forEach(function(e){"undefined"!=typeof e.ElementFieldSet&&e.ElementFieldSet.forEach(function(e){e.setOtherUsersIndexRatingTotal(),e.setOtherUsersIndexRatingCount(),"undefined"!=typeof e.ElementCellSet&&e.ElementCellSet.forEach(function(e){e.setOtherUsersNumericValueTotal(),e.setOtherUsersNumericValueCount()})})}),I()}function t(){return S.UserResourcePoolSet.length>0?S.UserResourcePoolSet[0]:null}function n(){return null===S.backingFields._currentUserResourcePoolRate&&S.setCurrentUserResourcePoolRate(!1),S.backingFields._currentUserResourcePoolRate}function r(){return null!==S.selectedElement().directIncomeField()&&S.selectedElement().elementFieldIndexSet().length>0}function l(){if(!S.UseFixedResourcePoolRate)return!0;for(var e=0;e<S.ElementSet.length;e++){var t=S.ElementSet[e];if(t.elementFieldIndexSet().length>1)return!0;if(t.elementFieldIndexSet().length>0&&!t.elementFieldIndexSet()[0].UseFixedValue)return!0}return!1}function o(){var e=[];return S.isTemp?e:(e.push(S),S.UserResourcePoolSet.forEach(function(t){e.push(t)}),S.ElementSet.forEach(function(t){e.push(t),t.ElementFieldSet.forEach(function(t){e.push(t),t.UserElementFieldSet.forEach(function(t){e.push(t)})}),t.ElementItemSet.forEach(function(t){e.push(t),t.ElementCellSet.forEach(function(t){e.push(t),t.UserElementCellSet.forEach(function(t){e.push(t)})})})}),e)}function i(e){return"undefined"!=typeof e&&(S.backingFields._isAdded=e),S.backingFields._isAdded}function a(){var e=S.ElementSet.filter(function(e){return e.IsMainElement});return e.length>0?e[0]:null}function u(){var e=S.Name;return e+=S.isEditing?" - Editing":""}function c(){return null===S.backingFields._otherUsersResourcePoolRateCount&&S.setOtherUsersResourcePoolRateCount(),S.backingFields._otherUsersResourcePoolRateCount}function s(){return null===S.backingFields._otherUsersResourcePoolRateTotal&&S.setOtherUsersResourcePoolRateTotal(),S.backingFields._otherUsersResourcePoolRateTotal}function d(){return null===S.backingFields._resourcePoolRate&&S.setResourcePoolRate(!1),S.backingFields._resourcePoolRate}function m(){return null===S.resourcePoolRateCount()?null:0===S.resourcePoolRateCount()?0:S.resourcePoolRateTotal()/S.resourcePoolRateCount()}function f(){return S.UseFixedResourcePoolRate?null!==S.currentUserResourcePool()&&S.currentUserResourcePool().UserId===S.UserId?1:S.otherUsersResourcePoolRateCount():S.otherUsersResourcePoolRateCount()+1}function g(){return null===S.backingFields._resourcePoolRatePercentage&&S.setResourcePoolRatePercentage(!1),S.backingFields._resourcePoolRatePercentage}function E(){return S.UseFixedResourcePoolRate?null!==S.currentUserResourcePool()&&S.currentUserResourcePool().UserId===S.UserId?S.currentUserResourcePoolRate():S.otherUsersResourcePoolRateTotal():S.otherUsersResourcePoolRateTotal()+S.currentUserResourcePoolRate()}function h(e){return"undefined"!=typeof e&&S.backingFields._selectedElement!==e&&(S.backingFields._selectedElement=e),null===S.backingFields._selectedElement&&S.mainElement()&&(S.backingFields._selectedElement=S.mainElement()),S.backingFields._selectedElement}function p(e){e="undefined"==typeof e?!0:e;var t=null!==S.currentUserResourcePool()?S.currentUserResourcePool().ResourcePoolRate:10;S.backingFields._currentUserResourcePoolRate!==t&&(S.backingFields._currentUserResourcePoolRate=t,e&&S.setResourcePoolRate())}function y(){S.backingFields._otherUsersResourcePoolRateCount=S.ResourcePoolRateCount,null!==S.currentUserResourcePool()&&S.backingFields._otherUsersResourcePoolRateCount--}function R(){S.backingFields._otherUsersResourcePoolRateTotal=null!==S.ResourcePoolRateTotal?S.ResourcePoolRateTotal:0,null!==S.currentUserResourcePool()&&(S.backingFields._otherUsersResourcePoolRateTotal-=S.currentUserResourcePool().ResourcePoolRate)}function P(e){e="undefined"==typeof e?!0:e;var t;if(S.UseFixedResourcePoolRate)t=S.resourcePoolRateAverage();else switch(S.RatingMode){case 1:t=S.currentUserResourcePoolRate();break;case 2:t=S.resourcePoolRateAverage()}S.backingFields._resourcePoolRate!==t&&(S.backingFields._resourcePoolRate=t,e&&S.setResourcePoolRatePercentage())}function v(e){e="undefined"==typeof e?!0:e;var t=0===S.resourcePoolRate()?0:S.resourcePoolRate()/100;S.backingFields._resourcePoolRatePercentage!==t&&(S.backingFields._resourcePoolRatePercentage=t,e&&S.ElementSet.forEach(function(e){e.ElementItemSet.forEach(function(e){e.setResourcePoolAmount()})}))}function C(){S.RatingMode=1===S.RatingMode?2:1}function F(){S.isAdded()&&(S.isAdded(!1),S.entityAspect.setAdded(),S.UserResourcePoolSet.forEach(function(e){e.entityAspect.setAdded()}),S.ElementSet.forEach(function(e){e.entityAspect.setAdded(),e.ElementFieldSet.forEach(function(e){e.entityAspect.setAdded(),e.UserElementFieldSet.forEach(function(e){e.entityAspect.setAdded()})}),e.ElementItemSet.forEach(function(e){e.entityAspect.setAdded(),e.ElementCellSet.forEach(function(e){e.entityAspect.setAdded(),e.UserElementCellSet.forEach(function(e){e.entityAspect.setAdded()})})})}))}function I(){var e=!1;S.setCurrentUserResourcePoolRate(),"undefined"!=typeof S.ElementSet&&S.ElementSet.forEach(function(t){t.setElementFieldIndexSet(),"undefined"!=typeof t.ElementFieldSet&&t.ElementFieldSet.forEach(function(t){t.IndexEnabled&&t.setCurrentUserIndexRating(),"undefined"!=typeof t.ElementCellSet&&t.ElementCellSet.forEach(function(t){switch(t.ElementField.DataType){case 1:t.UserElementCellSet.length>0&&(e=t.entityAspect.entityState.isUnchanged(),t.StringValue=t.UserElementCellSet[0].StringValue,e&&t.entityAspect.acceptChanges());break;case 2:case 3:case 4:t.setCurrentUserNumericValue();break;case 11:t.UserElementCellSet.length>0&&(e=t.entityAspect.entityState.isUnchanged(),t.NumericValueTotal=t.UserElementCellSet[0].DecimalValue,e&&t.entityAspect.acceptChanges()),t.setCurrentUserNumericValue();break;case 12:t.ElementItem.setMultiplier(),t.ElementField.IndexEnabled&&t.setNumericValueMultiplied()}})})})}var S=this;S.Id=0,S.UserId=0,S.Name="",S.InitialValue=0,S.ResourcePoolRateTotal=0,S.ResourcePoolRateCount=0,S.RatingCount=0,S.backingFields={_currentUserResourcePoolRate:null,_isAdded:!1,_otherUsersResourcePoolRateTotal:null,_otherUsersResourcePoolRateCount:null,_ratingMode:1,_resourcePoolRate:null,_resourcePoolRatePercentage:null,_selectedElement:null,_useFixedResourcePoolRate:!1},S.isEditing=!1,S.isTemp=!1,S.displayMultiplierFunctions=!0,S._init=e,S.currentUserResourcePool=t,S.currentUserResourcePoolRate=n,S.displayResourcePoolDetails=r,S.displayRatingMode=l,S.getEntities=o,S.isAdded=i,S.mainElement=a,S.name=u,S.otherUsersResourcePoolRateCount=c,S.otherUsersResourcePoolRateTotal=s,S.resourcePoolRate=d,S.resourcePoolRateAverage=m,S.resourcePoolRateCount=f,S.resourcePoolRatePercentage=g,S.resourcePoolRateTotal=E,S.selectedElement=h,S.setCurrentUserResourcePoolRate=p,S.setOtherUsersResourcePoolRateCount=y,S.setOtherUsersResourcePoolRateTotal=R,S.setResourcePoolRate=P,S.setResourcePoolRatePercentage=v,S.toggleRatingMode=C,S.updateAnonymousEntities=F,S.updateCache=I}return e=e.forSource(t),Object.defineProperty(n.prototype,"UseFixedResourcePoolRate",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._useFixedResourcePoolRate},set:function(e){this.backingFields._useFixedResourcePoolRate!==e&&(this.backingFields._useFixedResourcePoolRate=e,this.setResourcePoolRate())}}),Object.defineProperty(n.prototype,"RatingMode",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._ratingMode},set:function(e){this.backingFields._ratingMode!==e&&(this.backingFields._ratingMode=e,this.setResourcePoolRate(),this.ElementSet.forEach(function(e){e.ElementFieldSet.forEach(function(e){e.IndexEnabled&&e.setIndexRating(),e.UseFixedValue||e.ElementCellSet.forEach(function(t){switch(e.DataType){case 2:case 3:case 4:case 11:case 12:t.setNumericValue()}})})}))}}),n}var t="ResourcePool";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){function n(){function e(){var e=[];return e.push(r),r.ResourcePoolSet.forEach(function(t){var n=t.getEntities();n.forEach(function(t){e.push(t)})}),e}function t(){if("undefined"==typeof r.Claims)throw new Error("Invalid operation: Claims is undefined");for(var e=0;e<r.Claims.length;e++){var t=r.Claims[e];if("HasNoPassword"===t.ClaimType)return!1}return!0}function n(){return r.Id>0}var r=this;r.Id=0,r.Email="",r.EmailConfirmed=!1,r.UserName="",r.FirstName="",r.MiddleName="",r.LastName="",r.PhoneNumber="",r.PhoneNumberConfirmed=!1,r.TwoFactorEnabled=!1,r.AccessFailedCount=0,r.LockoutEnabled=!1,r.LockoutEndDateUtc=null,r.Notes="",r.CreatedOn=new Date,r.ModifiedOn=new Date,r.DeletedOn=null,r.isEditing=!1,r.getEntities=e,r.hasPassword=t,r.isAuthenticated=n}return e=e.forSource(t),n}var t="User";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){function n(){var e=this;e.UserId=0,e.ElementCellId=0,e.StringValue=null,e.BooleanValue=null,e.IntegerValue=null,e.DateTimeValue=null,e.backingFields={_DecimalValue:null},e.isEditing=!1}return e=e.forSource(t),Object.defineProperty(n.prototype,"DecimalValue",{enumerable:!0,configurable:!0,get:function(){return this.backingFields._DecimalValue},set:function(e){this.backingFields._DecimalValue!==e&&(this.backingFields._DecimalValue=e)}}),n}var t="UserElementCell";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){function n(){var e=this;e.UserId=0,e.ElementFieldId=0,e.Rating=0,e.isEditing=!1}return e=e.forSource(t),n}var t="UserElementField";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e){function n(){var e=this;e.UserId=0,e.ResourcePoolId=0,e.ResourcePoolRate=0,e.isEditing=!1}return e=e.forSource(t),n}var t="UserResourcePool";angular.module("main").factory(t,["logger",e])}(),function(){"use strict";function e(e,n,r,l){function o(){var t=n.defer();return null!==a?t.resolve(a):e.get(i).success(function(e){a=e,t.resolve(a)}).error(function(e,n,r,l){t.reject({data:e,status:n,headers:r,config:l})}),t.promise}l=l.forSource(t);var i=r+"/api/Application/ApplicationInfo",a=null,u={getApplicationInfo:o};return u}var t="applicationFactory";angular.module("main").factory(t,["$http","$q","serviceAppUrl","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){S=e.newManager()}function a(){S.clear()}function u(e,t){return"undefined"==typeof t.isEditing&&(t.isEditing=!0),S.createEntity(e,t)}function c(e,t){return u("UserElementCell",t)}function s(e,t){I=t}function d(e){return S.executeQuery(e)}function m(e,t,n){return S.fetchEntityByKey(e,t,n)}function f(e,t){e="undefined"!=typeof e?e:null,t="undefined"!=typeof t?t:null;var n=S.getChanges(),r=[];return n.forEach(function(n){n.isEditing||null!==e&&n.entityType.shortName!==e||null!==t&&n.entityAspect.entityState!==t||r.push(n)}),r}function g(){return f().length}function E(e,t){return S.getEntities(e,t)}function h(){return S.hasChanges()}function p(){if(null===b){var e=n.defer();b=e.promise,S.metadataStore.isEmpty()?S.fetchMetadata().then(function(){e.resolve()},function(t){e.reject(t)}):e.resolve()}return b}function y(){S.rejectChanges()}function R(e){return e="undefined"!=typeof e?e:0,I.isAuthenticated()?(null!==U&&l.cancel(U),0===e?P():U=l(function(){P()},e)):(r.$broadcast("anonymousUserInteracted"),n.reject({}))}function P(){function e(e){return o.logSuccess("Saved "+a+" change(s)"),e}function t(e){if("undefined"!=typeof e.status&&"409"===e.status)o.logError("Save failed!<br />The record you attempted to edit was modified by another user after you got the original value. The edit operation was canceled.",e,!0);else if("undefined"!=typeof e.entityErrors){var t="Save failed!<br />";for(var r in e.entityErrors){var l=e.entityErrors[r];t+=l.errorMessage+"<br />"}o.logError(t,null,!0)}else o.logError("Save failed!",e,!0);return n.reject(e)}function l(){r.$broadcast("saveChangesCompleted")}function i(){var e=[],t=f(null,breeze.EntityState.Modified);return t.forEach(function(e){var t=e.RowVersion;e.RowVersion="",e.RowVersion=t}),e.push(t),e.push(f("UserElementCell",breeze.EntityState.Deleted)),e.push(f("ElementCell",breeze.EntityState.Deleted)),e.push(f("ElementItem",breeze.EntityState.Deleted)),e.push(f("UserElementField",breeze.EntityState.Deleted)),e.push(f("ElementField",breeze.EntityState.Deleted)),e.push(f("Element",breeze.EntityState.Deleted)),e.push(f("UserResourcePool",breeze.EntityState.Deleted)),e.push(f("ResourcePool",breeze.EntityState.Deleted)),e.push(f("ResourcePool",breeze.EntityState.Added)),e.push(f("UserResourcePool",breeze.EntityState.Added)),e.push(f("Element",breeze.EntityState.Added)),e.push(f("ElementField",breeze.EntityState.Added)),e.push(f("UserElementField",breeze.EntityState.Added)),e.push(f("ElementItem",breeze.EntityState.Added)),e.push(f("ElementCell",breeze.EntityState.Added)),e.push(f("UserElementCell",breeze.EntityState.Added)),e}var a=g(),u=null,c=i();return c.forEach(function(e){(null===e||e.length>0)&&(r.$broadcast("saveChangesStart"),u=u?u.then(function(){return S.saveChanges(e)}):S.saveChanges(e))}),null===u&&(u=n.resolve(null)),u.then(e)["catch"](t)["finally"](l)}function v(e,t){return t="undefined"!=typeof t?t:0,I.isAuthenticated()?(null!==U&&l.cancel(U),0===t?C(e):U=l(function(){C(e)},t)):(r.$broadcast("anonymousUserInteracted"),n.reject({}))}function C(e){function t(e){return o.logSuccess("Saved "+u+" change(s)"),e}function l(e){if("undefined"!=typeof e.status&&"409"===e.status)o.logError("Save failed!<br />The record you attempted to edit was modified by another user after you got the original value. The edit operation was canceled.",e,!0);else if("undefined"!=typeof e.entityErrors){var t="Save failed!<br />";for(var r in e.entityErrors){var l=e.entityErrors[r];t+=l.errorMessage+"<br />"}o.logError(t,null,!0)}else o.logError("Save failed!",e,!0);return n.reject(e)}function i(){r.$broadcast("saveChangesCompleted")}function a(e){function t(e,t,n){var r=[];return e.forEach(function(e){e.entityType.shortName===t&&e.entityAspect.entityState===n&&r.push(e)}),r}var n=[],r=[];return e.forEach(function(e){if(e.entityAspect.entityState.isModified()){var t=e.RowVersion;e.RowVersion="",e.RowVersion=t,r.push(e)}}),n.push(r),n.push(t(e,"UserElementCell",breeze.EntityState.Deleted)),n.push(t(e,"ElementCell",breeze.EntityState.Deleted)),n.push(t(e,"ElementItem",breeze.EntityState.Deleted)),n.push(t(e,"UserElementField",breeze.EntityState.Deleted)),n.push(t(e,"ElementField",breeze.EntityState.Deleted)),n.push(t(e,"Element",breeze.EntityState.Deleted)),n.push(t(e,"UserResourcePool",breeze.EntityState.Deleted)),n.push(t(e,"ResourcePool",breeze.EntityState.Deleted)),n.push(t(e,"ResourcePool",breeze.EntityState.Added)),n.push(t(e,"UserResourcePool",breeze.EntityState.Added)),n.push(t(e,"Element",breeze.EntityState.Added)),n.push(t(e,"ElementField",breeze.EntityState.Added)),n.push(t(e,"UserElementField",breeze.EntityState.Added)),n.push(t(e,"ElementItem",breeze.EntityState.Added)),n.push(t(e,"ElementCell",breeze.EntityState.Added)),n.push(t(e,"UserElementCell",breeze.EntityState.Added)),n}var u=e.length,c=null,s=a(e);return s.forEach(function(e){(null===e||e.length>0)&&(r.$broadcast("saveChangesStart"),c=c?c.then(function(){return S.saveChanges(e)}):S.saveChanges(e))}),c.then(t)["catch"](l)["finally"](i)}function F(e,t){var r=n.defer();"undefined"!=typeof e&&null!==e||r.reject("anonymousUser parameter cannot be undefined or null"),"undefined"!=typeof t&&null!==t||r.reject("newUser parameter cannot be undefined or null");var l=[];return e.UserResourcePoolSet.forEach(function(e){var n=[t.Id,e.ResourcePoolId],r=m("UserResourcePool",n);l.push(r)}),e.UserElementFieldSet.forEach(function(e){var n=[t.Id,e.ElementFieldId],r=m("UserElementField",n);l.push(r)}),e.UserElementCellSet.forEach(function(e){var n=[t.Id,e.ElementCellId],r=m("UserElementCell",n);l.push(r)}),n.all(l).then(function(){e.ResourcePoolSet.forEach(function(e){e.User=t});var n=e.UserResourcePoolSet.slice();n.forEach(function(e){var n=t.UserResourcePoolSet.filter(function(t){return t.ResourcePoolId===e.ResourcePoolId});n.length>0?(n[0].ResourcePoolRate=e.ResourcePoolRate,e.entityAspect.rejectChanges()):e.User=t});var l=e.UserElementFieldSet.slice();l.forEach(function(e){var n=t.UserElementFieldSet.filter(function(t){return t.ElementFieldId===e.ElementFieldId});n.length>0?(n[0].Rating=e.Rating,e.entityAspect.rejectChanges()):e.User=t});var o=e.UserElementCellSet.slice();o.forEach(function(e){var n=t.UserElementCellSet.filter(function(t){return t.ElementCellId===e.ElementCellId});n.length>0?(n[0].StringValue=e.StringValue,n[0].BooleanValue=e.BooleanValue,n[0].IntegerValue=e.IntegerValue,n[0].DecimalValue=e.DecimalValue,n[0].DateTimeValue=e.DateTimeValue,e.entityAspect.rejectChanges()):e.User=t}),e.entityAspect.rejectChanges(),r.resolve()}),r.promise}o=o.forSource(t);var I={isAuthenticated:function(){return!1}},S=null,b=null,U=null,_={clear:a,createEntity:u,executeQuery:d,fetchEntityByKey:m,getChanges:f,getChangesCount:g,getEntities:E,hasChanges:h,metadataReady:p,rejectChanges:y,saveChanges:R,saveChangesAlt:v,updateAnonymousChanges:F};return r.$on("ElementField_createUserElementCell",c),r.$on("userFactory_currentUserChanged",s),i(),_}var t="dataContext";angular.module("main").factory(t,["entityManagerFactory","$q","$rootScope","$timeout","logger",e])}(),function(){"use strict";function e(e,n,r,l,o,i,a,u,c,s,d,m,f){function g(){var t=new e.EntityManager(h),d=t.metadataStore;return d.registerEntityTypeCtor("Element",n),d.registerEntityTypeCtor("ElementCell",r),d.registerEntityTypeCtor("ElementField",l),d.registerEntityTypeCtor("ElementItem",o),d.registerEntityTypeCtor("ResourcePool",i),d.registerEntityTypeCtor("User",a),d.registerEntityTypeCtor("UserElementCell",u),d.registerEntityTypeCtor("UserElementField",c),d.registerEntityTypeCtor("UserResourcePool",s),t}f=f.forSource(t);var E=m,h=E+"/odata",p={newManager:g,serviceName:h};return p}var t="entityManagerFactory";angular.module("main").factory(t,["breeze","Element","ElementCell","ElementField","ElementItem","ResourcePool","User","UserElementCell","UserElementField","UserResourcePool","$rootScope","serviceAppUrl","logger",e])}(),function(){"use strict";function e(e,n,r){function l(t,r){function l(e){var t=new a(i,c,e,d);u.history.push(t),u.history.length>u.historyLimit&&u.history.splice(0,u.history.length-u.historyLimit),o.resolve()}var o=n.defer(),i=t.url(),c=r.accessType,s=r.params.resourcePoolId,d="edit"===t.path().substring(t.path().lastIndexOf("/")+1);return"undefined"!=typeof s?e.getResourcePool(s).then(l):l(),o.promise}function o(){return u.history.slice()}function i(e){e="undefined"!=typeof e?e:"";for(var t=u.history.length-2;t>=0;t--){var n=u.history[t];if(""===e||e!==n.accessType)return n}}function a(e,t,n,r){function l(){return null!==o.resourcePool?o.isEdit?"/_system/resourcePool/"+o.resourcePool.Id+"/edit":"/_system/resourcePool/"+o.resourcePool.Id:o.itemUrl}e="undefined"!=typeof e?e:"",t="undefined"!=typeof t?t:"undefined",n="undefined"!=typeof n?n:null,r="undefined"!=typeof r?r:!1;var o=this;o.itemUrl=e,o.accessType=t,o.resourcePool=n,o.isEdit=r,o.url=l}r=r.forSource(t);var u={history:[new a("/")],historyLimit:10},c={createItem:l,getHistory:o,previousItem:i};return c}var t="locationHistory";angular.module("main").factory(t,["resourcePoolFactory","$q","logger",e])}(),function(){"use strict";function e(e){function t(){toastr.options={positionClass:"toast-bottom-right"}}function n(e){return{log:function(t,n,l,o,i){return r(t,n,e,l,o,i)},logError:function(t,n,r,o,i){return l(t,n,e,r,o,i)},logInfo:function(t,n,r,l,i){return o(t,n,e,r,l,i)},logSuccess:function(t,n,r,l,o){return i(t,n,e,r,l,o)},logWarning:function(t,n,r,l,o){return a(t,n,e,r,l,o)}}}function r(e,t,n,r,l,o){return u(e,t,n,r,l,o,"debug")}function l(e,t,n,r,l,o){return u(e,t,n,r,l,o,"error")}function o(e,t,n,r,l,o){return u(e,t,n,r,l,o,"info")}function i(e,t,n,r,l,o){return u(e,t,n,r,l,o,"success")}function a(e,t,n,r,l,o){return u(e,t,n,r,l,o,"warning")}function u(t,n,r,l,o,i,a){l="undefined"==typeof l?!1:l;var u=(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds();r=r?"["+r+"] ":"";var c;switch(a){case"debug":c=e.debug;break;case"error":c=e.error;break;case"info":c=e.info;break;case"success":c=e.log;break;case"warning":c=e.warn}c(u,r,t,n);var s=null;if(l)switch(a){case"debug":s=toastr.info(t,o,i);break;case"error":s=toastr.error(t,o,i);break;case"info":s=toastr.info(t,o,i);break;case"success":s=toastr.success(t,o,i);break;case"warning":s=toastr.warning(t,o,i)}return s}t();var c={forSource:n,log:r,logError:l,logInfo:o,logSuccess:i,logWarning:a};return c}angular.module("main").factory("logger",["$log",e])}(),function(){"use strict";function e(e){e.decorator(n,["$delegate","ResourcePool","Element","userFactory","dataContext","$rootScope","logger",t])}function t(e,t,r,l,o,i,a){function u(e){e.entityAspect.entityState.isAdded()&&e.isAdded(!0),e.entityAspect.acceptChanges(),e.isAdded()&&e.entityAspect.setModified(),e.UserResourcePoolSet.forEach(function(e){e.entityAspect.acceptChanges()}),e.ElementSet.forEach(function(e){e.entityAspect.acceptChanges(),e.ElementFieldSet.forEach(function(e){e.entityAspect.acceptChanges(),e.UserElementFieldSet.forEach(function(e){e.entityAspect.acceptChanges()})}),e.ElementItemSet.forEach(function(e){e.entityAspect.acceptChanges(),e.ElementCellSet.forEach(function(e){e.entityAspect.acceptChanges(),e.UserElementCellSet.forEach(function(e){e.entityAspect.acceptChanges()})})})})}function c(e){e.entityAspect.rejectChanges(),e.UserResourcePoolSet.forEach(function(e){e.entityAspect.rejectChanges()}),e.ElementSet.forEach(function(e){e.entityAspect.rejectChanges(),e.ElementFieldSet.forEach(function(e){e.entityAspect.rejectChanges(),e.UserElementFieldSet.forEach(function(e){e.entityAspect.rejectChanges()})}),e.ElementItemSet.forEach(function(e){e.entityAspect.rejectChanges(),e.ElementCellSet.forEach(function(e){e.entityAspect.rejectChanges(),e.UserElementCellSet.forEach(function(e){e.entityAspect.rejectChanges()})})})})}function s(e){}function d(e){return o.createEntity("Element",e)}function m(e){var t=o.createEntity("ElementCell",e);if(6!==t.ElementField.DataType){var n={User:t.ElementField.Element.ResourcePool.User,ElementCell:t};switch(t.ElementField.DataType){case 1:n.StringValue="";break;case 2:n.BooleanValue=!1;break;case 3:n.IntegerValue=0;break;case 4:n.DecimalValue=50;break;case 11:n.DecimalValue=100;break;case 12:n.DecimalValue=0}o.createEntity("UserElementCell",n)}return t}function f(e){return e=o.createEntity("ElementField",e),e.Element.ElementItemSet.forEach(function(t){m({ElementField:e,ElementItem:t})}),e}function g(e){return e=o.createEntity("ElementItem",e),e.Element.ElementFieldSet.forEach(function(t){m({ElementField:t,ElementItem:e})}),e}function E(e){return e="undefined"!=typeof e?e:!1,l.getCurrentUser().then(function(t){var n=10,r=o.createEntity("ResourcePool",{User:t,Name:"New CMRP",InitialValue:100,UseFixedResourcePoolRate:!0});o.createEntity("UserResourcePool",{User:t,ResourcePool:r,ResourcePoolRate:n});var l=d({ResourcePool:r,Name:"New element"});l.IsMainElement=!0;f({Element:l,Name:"Importance",DataType:4,UseFixedValue:!1,IndexEnabled:!0,IndexCalculationType:2,IndexSortType:1,SortOrder:1}),g({Element:l,Name:"New item 1"}),g({Element:l,Name:"New item 2"});return e&&r._init(!0),r})}function h(e){return e="undefined"!=typeof e?e:!1,E().then(function(t){var n=t.mainElement().ElementFieldSet[0];n.Name="Sales Price",n.DataType=11,n.UseFixedValue=!0,n.IndexEnabled=!1,n.IndexCalculationType=0,n.IndexSortType=0;n.ElementCellSet[0],n.ElementCellSet[1],f({Element:t.mainElement(),Name:"Number of Sales",DataType:12,UseFixedValue:!1,SortOrder:2});return e&&t._init(!0),t})}function p(e){return e="undefined"!=typeof e?e:!1,E().then(function(t){var n=t.ElementSet[0];n.Name="Child";var r=n.ElementItemSet[0],l=n.ElementItemSet[1],o=d({ResourcePool:t,Name:"Parent"});o.IsMainElement=!0;var i=(f({Element:o,Name:"Child",DataType:6,SelectedElement:n,UseFixedValue:!0,SortOrder:1}),g({Element:o,Name:"Parent 1"}));i.ElementCellSet[0].SelectedElementItem=r;var a=g({Element:o,Name:"Parent 2"});return a.ElementCellSet[0].SelectedElementItem=l,e&&t._init(!0),t})}function y(e){return e=Number(e),l.getCurrentUser().then(function(t){function n(e){if(0===e.results.length)return null;var t=e.results[0];return c&&t._init(),I.push(t.Id),t}function r(e){var t=e.message||"ResourcePool query failed";a.logError(t,e,!0)}var l=null,i=0>=e,u=!1,c=!1;return i||(u=I.some(function(t){return e===t})),c=!i&&!u,l=t.isAuthenticated()||i?breeze.EntityQuery.from("ResourcePool").expand("UserResourcePoolSet, ElementSet.ElementFieldSet.UserElementFieldSet, ElementSet.ElementItemSet.ElementCellSet.UserElementCellSet").where("Id","eq",e):breeze.EntityQuery.from("ResourcePool").expand("ElementSet.ElementFieldSet, ElementSet.ElementItemSet.ElementCellSet").where("Id","eq",e),l=c?l.using(breeze.FetchStrategy.FromServer):l.using(breeze.FetchStrategy.FromLocalCache),o.executeQuery(l).then(n)["catch"](r)})}function R(e){e.ResourcePool.selectedElement()===e&&e.ResourcePool.selectedElement(null);var t=e.ElementItemSet.slice();t.forEach(function(e){C(e)});var n=e.ElementFieldSet.slice();n.forEach(function(e){v(e)}),e.entityAspect.setDeleted()}function P(e){var t=e.UserElementCellSet.slice();t.forEach(function(e){e.entityAspect.setDeleted()}),e.entityAspect.setDeleted()}function v(e){var t=e.ElementCellSet.slice();t.forEach(function(e){P(e)});var n=e.UserElementFieldSet.slice();n.forEach(function(e){e.entityAspect.setDeleted()}),e.entityAspect.setDeleted()}function C(e){var t=e.ElementCellSet.slice();t.forEach(function(e){P(e)}),e.entityAspect.setDeleted()}function F(e){var t=e.ElementSet.slice();t.forEach(function(e){R(e)});var n=e.UserResourcePoolSet.slice();n.forEach(function(e){e.entityAspect.setDeleted()}),e.entityAspect.setDeleted()}a=a.forSource(n);var I=[];return e.acceptChanges=u,e.cancelResourcePool=c,e.copyResourcePool=s,e.createElement=d,e.createElementField=f,e.createElementItem=g,e.createResourcePoolBasic=E,e.createResourcePoolDirectIncomeAndMultiplier=h,e.createResourcePoolTwoElements=p,e.getResourcePoolExpanded=y,e.removeElement=R,e.removeElementField=v,e.removeElementItem=C,e.removeResourcePool=F,i.$on("userFactory_currentUserChanged",function(){I=[]}),e}var n="resourcePoolFactory";angular.module("main").config(["$provide",e])}(),function(){"use strict";function e(e){e.decorator(n,["$delegate","dataContext","$http","$q","$rootScope","$window","$location","serviceAppUrl","logger",t])}function t(e,t,r,l,o,i,a,u,c){function s(){h().then(function(){C()})}function d(e){return r.post(A,e).success(function(e){for(var t=null,n=0;n<$.Claims.length;n++)if("HasNoPassword"===$.Claims[n].ClaimType){t=n;break}var r=$.Claims.splice(t,1);r[0].entityAspect.setDetached(),U($,e)}).error(P)}function m(e){return r.post(D,e).success(function(e){$.Email=e.Email,$.EmailConfirmed=!1,U($,e)}).error(P)}function f(e){return r.post(T,e).success(function(e){U($,e)}).error(P)}function g(e){return r.post(N,e).success(function(e){$.EmailConfirmed=!0,U($,e)}).error(P)}function E(e,n,o,a,u){u="undefined"==typeof u?!1:u;var c=l.defer(),s="grant_type=password&username="+e+"&password="+n+"&rememberMe="+o+"&tempToken="+("undefined"!=typeof a?a:"");return r.post(B,s,{"Content-Type":"application/x-www-form-urlencoded"}).success(function(e){i.localStorage.setItem("token",angular.toJson(e));var n=$;h(!u).then(function(){u?(C(),$.ResourcePoolSet.forEach(function(e){e.updateAnonymousEntities()}),t.saveChanges().then(function(){c.resolve()})):(C(),t.updateAnonymousChanges(n,$).then(function(){$.ResourcePoolSet.forEach(function(e){e.updateAnonymousEntities()}),t.saveChanges().then(function(){c.resolve()})}))})}).error(function(e,t,n,r){P(e,t,n,r),c.reject(e)}),c.promise}function h(e){function n(e){var n=e.results.length>0?e.results[0]:t.createEntity("User",{isEditing:!1});$=n,o.resolve(n)}function r(e){var t=e.message||"User query failed";throw o.reject(t),new Error(t)}if(e="undefined"!=typeof e?e:!1,null===q||e){var o=l.defer();if(q=o.promise,null===localStorage.getItem("token"))t.metadataReady().then(function(){var e=t.createEntity("User",{isEditing:!1});$=e,o.resolve(e)})["catch"](function(){});else{var i=breeze.EntityQuery.from("Users").expand("Claims").using(breeze.FetchStrategy.FromServer);t.executeQuery(i).then(n)["catch"](r)}}return q}function p(e,n){var r=n.currentUserCell();if(null===r){var l=t.getEntities(["UserElementCell"],[breeze.EntityState.Deleted]),o=l.filter(function(t){return t.UserId===e.Id&&t.ElementCellId===n.Id});o.length>0&&(r=o[0],r.entityAspect.rejectChanges(),r.DecimalValue=12===n.ElementField.DataType?0:50)}return r}function y(e,n){var r=n.currentUserElementField();if(null===r){var l=t.getEntities(["UserElementField"],[breeze.EntityState.Deleted]),o=l.filter(function(t){return t.UserId===e.Id&&t.ElementFieldId===n.Id});o.length>0&&(r=o[0],r.entityAspect.rejectChanges(),r.Rating=50)}return r}function R(e,n){var r=n.currentUserResourcePool();if(null===r){var l=t.getEntities(["UserResourcePool"],[breeze.EntityState.Deleted]),o=l.filter(function(t){return t.UserId===e.Id&&t.ResourcePoolId===n.Id});o.length>0&&(r=o[0],r.entityAspect.rejectChanges(),r.ResourcePoolRate=10)}return r}function P(e,t,n,r){function l(e){o+=e+"<br />"}var o="";if("undefined"!=typeof e.ModelState)for(var i in e.ModelState){var a=e.ModelState[i];a.forEach(l)}""===o&&"undefined"!=typeof e.Message&&(o=e.Message),""===o&&"undefined"!=typeof e.error_description&&(o=e.error_description),c.logError(o,null,!0)}function v(){return i.localStorage.removeItem("token"),t.clear(),h(!0).then(function(){C()})}function C(){o.$broadcast("userFactory_currentUserChanged",$)}function F(e){return r.post(O,e).success(function(t){return $.Id=t.Id,$.Email=t.Email,$.UserName=t.UserName,$.RowVersion=t.RowVersion,$.entityAspect.acceptChanges(),E(e.email,e.password,!1,!0)}).error(P)}function I(){return r.post(z).error(P)}function S(e){return r.post(j,e).success(function(e){U($,e)}).error(P)}function b(e){return r.post(H,e).error(P)}function U(e,t){e.RowVersion=t.RowVersion}function _(e,t){e.ElementItemSet.forEach(function(e){for(var n,r=0;r<e.ElementCellSet.length;r++){var l=e.ElementCellSet[r];if(12===l.ElementField.DataType){n=l;break}}k(n,t)}),e.ElementItemSet.forEach(function(e){e.setMultiplier()}),e.ElementFieldSet.forEach(function(e){e.IndexEnabled&&(e.ElementCellSet.forEach(function(e){e.setNumericValueMultiplied(!1)}),e.setNumericValueMultiplied())})}function x(e,t){k(e,t),e.ElementField.Element.ElementItemSet.forEach(function(e){e.setMultiplier()}),e.ElementField.IndexEnabled&&(e.ElementField.ElementCellSet.forEach(function(e){e.setNumericValueMultiplied(!1)}),e.ElementField.setNumericValueMultiplied())}function k(e,n){var r=p($,e);switch(n){case"increase":case"decrease":null===r?r=t.createEntity("UserElementCell",{User:$,ElementCell:e,DecimalValue:"increase"===n?1:0,isEditing:!1}):r.DecimalValue="increase"===n?r.DecimalValue+1:r.DecimalValue-1<0?0:r.DecimalValue-1;break;case"reset":
null!==r&&r.entityAspect.setDeleted()}}function M(e,n){var r=p($,e);switch(n){case"increase":case"decrease":null===r?t.createEntity("UserElementCell",{User:$,ElementCell:e,DecimalValue:"increase"===n?55:45,isEditing:!1}):r.DecimalValue="increase"===n?r.DecimalValue+5>100?100:r.DecimalValue+5:r.DecimalValue-5<0?0:r.DecimalValue-5,e.setCurrentUserNumericValue();break;case"reset":null!==r&&(r.entityAspect.setDeleted(),e.setCurrentUserNumericValue())}}function V(e,n){var r=y($,e);switch(n){case"increase":case"decrease":null===r?(r={User:$,ElementField:e,Rating:"increase"===n?55:45,isEditing:!1},t.createEntity("UserElementField",r)):r.Rating="increase"===n?r.Rating+5>100?100:r.Rating+5:r.Rating-5<0?0:r.Rating-5,e.setCurrentUserIndexRating();break;case"reset":null!==r&&(r.entityAspect.setDeleted(),e.setCurrentUserIndexRating())}}function w(e,n){var r=R($,e);switch(n){case"increase":case"decrease":null===r?(r={User:$,ResourcePool:e,ResourcePoolRate:"increase"===n?15:5,isEditing:!1},t.createEntity("UserResourcePool",r)):r.ResourcePoolRate="increase"===n?r.ResourcePoolRate+5>1e3?1e3:r.ResourcePoolRate+5:r.ResourcePoolRate-5<0?0:r.ResourcePoolRate-5,e.setCurrentUserResourcePoolRate();break;case"reset":null!==r&&(r.entityAspect.setDeleted(),e.setCurrentUserResourcePoolRate())}}c=c.forSource(n);var A=u+"/api/Account/AddPassword",D=u+"/api/Account/ChangeEmail",T=u+"/api/Account/ChangePassword",N=u+"/api/Account/ConfirmEmail",$=null,q=null,O=u+"/api/Account/Register",z=u+"/api/Account/ResendConfirmationEmail",j=u+"/api/Account/ResetPassword",H=u+"/api/Account/ResetPasswordRequest",B=u+"/api/Token";return e.addPassword=d,e.changeEmail=m,e.changePassword=f,e.confirmEmail=g,e.getCurrentUser=h,e.getToken=E,e.logout=v,e.register=F,e.resendConfirmationEmail=I,e.resetPassword=S,e.resetPasswordRequest=b,e.updateElementMultiplier=_,e.updateElementCellMultiplier=x,e.updateElementCellNumericValue=M,e.updateElementFieldIndexRating=V,e.updateResourcePoolRate=w,s(),e}var n="userFactory";angular.module("main").config(["$provide",e])}(),function(){"use strict";angular.module("main").filter("enum",["Enums","logger",function(e,t){return function(t,n){return"undefined"==typeof t||"undefined"==typeof n||""===n?null:e.getEnumKey(n,t)}}])}(),function(){"use strict";angular.module("main").filter("numberSymbol",["$filter","logger",function(e,t){return function(t,n){if("undefined"==typeof t)return null;n="undefined"==typeof n?0:n;var r=Number(t);r=n>0?r.toFixed(n):r;var l="";return r/Math.pow(10,12)>=1?(r/=Math.pow(10,12),l="T"):r/Math.pow(10,9)>=1?(r/=Math.pow(10,9),l="B"):r/Math.pow(10,6)>=1?(r/=Math.pow(10,6),l="M"):r/Math.pow(10,3)>=1?(r/=Math.pow(10,3),l="K"):r=r,e("number")(r,n)+l}}])}(),function(){"use strict";angular.module("main").filter("percentage",["$filter",function(e){return function(t,n){return e("number")(100*t,n)+"%"}}])}(),function(){"use strict";function e(e,n){function r(){}function l(){return i}function o(){i=!0,a.user.isEditing=!1,e.saveChanges().then(function(e){n.logSuccess("Your changes have been saved!",null,!0)})["catch"](function(e){"409"===e.status})["finally"](function(){i=!1})}n=n.forSource(t);var i=!1,a=this;a.cancelChanges=r,a.isSaveDisabled=l,a.user=null,a.saveChanges=o,e.getCurrentUser().then(function(e){a.user=e,a.user.isEditing=!0})}var t="AccountEditController";angular.module("main").controller(t,["userFactory","logger",e])}(),function(){"use strict";function e(e,n,r){function l(){e.addPassword(o).success(function(){n.url("/"),r.logSuccess("Your password has been set!",null,!0)})}r=r.forSource(t);var o=this;o.addPassword=l}var t="AddPasswordController";angular.module("main").controller(t,["userFactory","$location","logger",e])}(),function(){"use strict";function e(e,n,r){function l(){if("localhost"===n.host()){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,l=e.getDate(),o=e.getHours(),a=e.getMinutes(),u=e.getSeconds(),c="local_"+t+r+l+"_"+o+a+u+"@forcrowd.org";i.email=c}}function o(){i.isChangeEmailDisabled=!0,e.changeEmail(i).success(function(){n.url("/_system/account/confirmEmail")})["finally"](function(){i.isChangeEmailDisabled=!1})}r=r.forSource(t);var i=this;i.isChangeEmailDisabled=!1,i.changeEmail=o,l()}var t="ChangeEmailController";angular.module("main").controller(t,["userFactory","$location","logger",e])}(),function(){"use strict";function e(e,n,r){function l(){e.changePassword(o).success(function(){n.url("/"),r.logSuccess("Your password has been changed!",null,!0)})}r=r.forSource(t);var o=this;o.changePassword=l}var t="ChangePasswordController";angular.module("main").controller(t,["userFactory","$location","logger",e])}(),function(){"use strict";function e(e,n,r,l){function o(){e.getCurrentUser().then(function(t){if(a.currentUser=t,a.currentUser.isAuthenticated()){var n=r.search().token;"undefined"!=typeof n&&e.confirmEmail({Token:n})}})}function i(){a.isResendDisabled=!0,e.resendConfirmationEmail().then(function(){l.logSuccess("Confirmation email has been resent to your email address!",null,!0)})["finally"](function(){a.isResendDisabled=!1})}l=l.forSource(t);var a=this;a.currentUser={EmailConfirmed:!1,isAuthenticated:function(){return!1}},a.isResendDisabled=!1,a.resendConfirmationEmail=i,o()}var t="ConfirmEmailController";angular.module("main").controller(t,["userFactory","$rootScope","$location","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){var e=n.search().error;return"undefined"!=typeof e?void o.logError(e,null,!0):void a()}function a(){function t(){o.logSuccess("You have been logged in!",null,!0),n.url(c())}function r(){o.logError("Invalid token",null,!0)}var l=n.search().tempToken;"undefined"!=typeof l?e.getToken("","",s.rememberMe,l).then(t)["catch"](r):""!==s.email&&""!==s.password&&e.getToken(s.email,s.password,s.rememberMe).then(t)}function u(e){return l+"/api/Account/ExternalLogin?provider="+e+"&clientReturnUrl="+c()}function c(){var e=n.search().clientReturnUrl;return"undefined"!=typeof e?e:r.previousItem().url()}o=o.forSource(t);var s=this;s.email="",s.login=a,s.getExternalLoginUrl=u,s.password="",s.rememberMe=!1,i()}var t="LoginController";angular.module("main").controller(t,["userFactory","$location","locationHistory","serviceAppUrl","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){if("localhost"===n.host()){var e=new Date,t=e.getFullYear(),r=e.getMonth()+1,l=e.getDate(),o=e.getHours(),i=e.getMinutes(),a=e.getSeconds(),u="local_"+t+r+l+"_"+o+i+a+"@forcrowd.org";c.email=u,c.password="q1w2e3",c.confirmPassword="q1w2e3"}}function a(e){var t=r.previousItem().url();return l+"/api/Account/ExternalLogin?provider="+e+"&clientReturnUrl="+t}function u(){e.register(c).success(function(){o.logSuccess("You have been registered!",null,!0),n.url("/_system/account/confirmEmail")}).error(function(e){"undefined"!=typeof e.error_description&&o.logError(e.error_description,null,!0)})}o=o.forSource(t);var c=this;c.confirmPassword="",c.email="",c.getExternalLoginUrl=a,c.password="",c.register=u,i()}var t="RegisterController";angular.module("main").controller(t,["userFactory","$location","locationHistory","serviceAppUrl","logger",e])}(),function(){"use strict";function e(e,n,r){function l(){var t=i;e.resetPassword(t).success(function(){n.url("/_system/account/login"),r.logSuccess("Your password has been reset!",null,!0)})}function o(){var t=i;e.resetPasswordRequest(t).success(function(){i.viewMode="sent"})}r=r.forSource(t);var i=this;i.email=n.search().email,i.token=n.search().token,i.resetPassword=l,i.resetPasswordRequest=o,i.viewMode="undefined"==typeof n.search().email||"undefined"==typeof n.search().token?"initial":"received"}var t="ResetPasswordController";angular.module("main").controller(t,["userFactory","$location","logger",e])}(),function(){"use strict";function e(e,n){function r(){e.getResourcePoolSet(!1).then(function(e){l.resourcePoolSet=e})}n=n.forSource(t);var l=this;l.resourcePoolSet=[],r()}var t="ResourcePoolListController";angular.module("main").controller(t,["resourcePoolFactory","logger",e])}(),function(){"use strict";function e(e,l,o,i,a,u,c,s){function d(){O.isNew?e.createResourcePoolBasic().then(function(e){O.resourcePool=e,O.resourcePool.isEditing=!0,a.viewTitle=O.resourcePool.Name}):e.getResourcePoolExpanded(O.resourcePoolId).then(function(e){return null===e?void o.url("/_system/content/404"):(O.resourcePool=e,O.resourcePool.isEditing=!0,void(a.viewTitle=O.resourcePool.Name))})}function m(){O.element=e.createElement({ResourcePool:O.resourcePool,Name:"New element",IsMainElement:!1}),O.isElementEdit=!0,O.isElementNew=!0}function f(){var t=O.resourcePool.ElementSet[0],n=t.ElementFieldSet.length+1;O.elementField=e.createElementField({Element:t,Name:"New field",DataType:1,SortOrder:n}),O.isElementFieldEdit=!0,O.isElementFieldNew=!0}function g(){O.elementItem={Element:O.resourcePool.ElementSet[0],Name:"New item"},O.isElementItemEdit=!0,O.isElementItemNew=!0}function E(){O.isElementNew?e.removeElement(O.element):O.element.Name=O.elementMaster.Name,O.isElementEdit=!1,O.element=null,O.elementMaster=null}function h(){O.elementCell.SelectedElementItemId=O.elementCellMaster.SelectedElementItemId,O.elementCell.UserElementCellSet[0].StringValue=O.elementCellMaster.UserElementCellSet[0].StringValue,O.elementCell.UserElementCellSet[0].BooleanValue=O.elementCellMaster.UserElementCellSet[0].BooleanValue,O.elementCell.UserElementCellSet[0].IntegerValue=O.elementCellMaster.UserElementCellSet[0].IntegerValue,O.elementCell.UserElementCellSet[0].DecimalValue=O.elementCellMaster.UserElementCellSet[0].DecimalValue,O.elementCell.UserElementCellSet[0].DateTimeValue=O.elementCellMaster.UserElementCellSet[0].DateTimeValue,O.isElementCellEdit=!1,O.elementCell=null,O.elementCellMaster=null}function p(){O.isElementFieldNew?e.removeElementField(O.elementField):(O.elementField.Name=O.elementFieldMaster.Name,O.elementField.DataType=O.elementFieldMaster.DataType,O.elementField.SelectedElementId=O.elementFieldMaster.SelectedElementId,O.elementField.UseFixedValue=O.elementFieldMaster.UseFixedValue,O.elementField.IndexEnabled=O.elementFieldMaster.IndexEnabled,O.elementField.IndexCalculationType=O.elementFieldMaster.IndexCalculationType,O.elementField.IndexSortType=O.elementFieldMaster.IndexSortType,O.elementField.SortOrder=O.elementFieldMaster.SortOrder),O.isElementFieldEdit=!1,O.elementField=null,O.elementFieldMaster=null}function y(){O.isElementItemNew||(O.elementItem.Name=O.elementItemMaster.Name),O.isElementItemEdit=!1,O.elementItem=null,O.elementItemMaster=null}function R(){e.cancelResourcePool(O.resourcePool);var t=O.isNew?"/_system/resourcePool":"/_system/resourcePool/"+O.resourcePool.Id;o.url(t)}function P(e){O.elementMaster=angular.copy(e),O.element=e,O.isElementEdit=!0,O.isElementNew=!1}function v(e){O.elementCellMaster=angular.copy(e),O.elementCell=e,O.isElementCellEdit=!0}function C(e){O.elementFieldMaster=angular.copy(e),O.elementField=e,O.isElementFieldEdit=!0,O.isElementFieldNew=!1}function F(e){O.elementItemMaster=angular.copy(e),O.elementItem=e,O.isElementItemEdit=!0,O.isElementItemNew=!1}function I(){var e=U(),t=[];return e.forEach(function(e){e.ElementCellSet.forEach(function(e){t.push(e)})}),t}function S(){var e=[];return O.resourcePool.ElementSet.forEach(function(t){t.ElementFieldSet.forEach(function(t){e.push(t)})}),e}function b(){function e(e){return O.ElementFieldDataType[n]===e.ElementFieldDataType}var t={};for(var n in O.ElementFieldDataType)if("DirectIncome"===n||"Multiplier"===n){var r=O.elementField.Element.ElementFieldSet.some(e);r||(t[n]=O.ElementFieldDataType[n])}else"Element"===n?O.elementField.Element.ResourcePool.ElementSet.length>1&&(t[n]=O.ElementFieldDataType[n]):t[n]=O.ElementFieldDataType[n];return t}function U(){var e=[];return O.resourcePool.ElementSet.forEach(function(t){t.ElementItemSet.forEach(function(t){e.push(t)})}),e}function _(){var e=!O.isSaving&&"undefined"!=typeof O.resourcePoolForm&&O.resourcePoolForm.$valid;return e}function x(){var e=u.open({templateUrl:"copyResourcePoolModal.html",controllerAs:"vm",controller:["resourcePoolFactory","$uibModalInstance",n]});e.result.then(function(e){O.resourcePool=e})}function k(){var e=u.open({templateUrl:"removeResourcePoolModal.html",controller:["$scope","$uibModalInstance",t]});e.result.then(function(){A()})}function M(t){e.removeElement(t)}function V(t){e.removeElementField(t)}function w(t){e.removeElementItem(t)}function A(){O.isSaving=!0,e.removeResourcePool(O.resourcePool),l.getCurrentUser().then(function(t){t.isAuthenticated()?e.saveChanges().then(function(){o.url("/_system/resourcePool")})["finally"](function(){O.isSaving=!1}):(o.url("/_system/resourcePool"),O.isSaving=!1)})}function D(){O.isElementEdit=!1,O.element=null,O.elementMaster=null}function T(){O.isElementCellEdit=!1,O.elementCell=null,O.elementCellMaster=null}function N(){O.elementField.DataType!==O.ElementFieldDataType.String&&O.elementField.DataType!==O.ElementFieldDataType.Element||(O.elementField.UseFixedValue=null),O.elementField.DataType===O.ElementFieldDataType.Multiplier&&(O.elementField.UseFixedValue=!1),O.elementField.DataType===O.ElementFieldDataType.DirectIncome&&(O.elementField.UseFixedValue=!0),O.isElementFieldEdit=!1,O.elementField=null,O.elementFieldMaster=null}function $(){O.isElementItemNew&&(O.elementItem=e.createElementItem(O.elementItem)),O.isElementItemEdit=!1,O.elementItem=null,O.elementItemMaster=null}function q(){O.isSaving=!0,O.resourcePool.updateCache(),l.getCurrentUser().then(function(t){O.resourcePool.isEditing=!1,O.resourcePool.UserResourcePoolSet.forEach(function(e){e.isEditing=!1}),O.resourcePool.ElementSet.forEach(function(e){e.isEditing=!1,e.ElementFieldSet.forEach(function(e){e.isEditing=!1,e.UserElementFieldSet.forEach(function(e){e.isEditing=!1})}),e.ElementItemSet.forEach(function(e){e.isEditing=!1,e.ElementCellSet.forEach(function(e){e.isEditing=!1,e.UserElementCellSet.forEach(function(e){e.isEditing=!1})})})}),t.isAuthenticated()?e.saveChanges().then(function(){o.url("/_system/resourcePool/"+O.resourcePool.Id)})["finally"](function(){O.isSaving=!1}):(e.acceptChanges(O.resourcePool),O.isSaving=!1,o.url("/_system/resourcePool/"+O.resourcePool.Id))})}s=s.forSource(r);var O=this;O.addElement=m,O.addElementField=f,O.addElementItem=g,O.cancelElement=E,O.cancelElementCell=h,O.cancelElementField=p,O.cancelElementItem=y,O.cancelResourcePool=R,O.editElement=P,O.editElementCell=v,O.editElementField=C,O.editElementItem=F,O.element=null,O.elementMaster=null,O.elementCell=null,O.elementCellMaster=null,O.elementCellSet=I,O.elementField=null,O.elementFieldMaster=null,O.elementFieldSet=S,O.elementFieldDataTypeFiltered=b,O.elementItem=null,O.elementItemMaster=null,O.elementItemSet=U,O.entityErrors=[],O.isElementEdit=!1,O.isElementNew=!0,O.isElementFieldEdit=!1,O.isElementFieldNew=!0,O.isElementItemEdit=!1,O.isElementItemNew=!0,O.isNew="/_system/resourcePool/new"===o.path(),O.isSaveEnabled=_,O.isSaving=!1,O.openCopyModal=x,O.openRemoveResourcePoolModal=k,O.removeElement=M,O.removeElementField=V,O.removeElementItem=w,O.removeResourcePool=A,O.resourcePool={ElementSet:[]},O.resourcePoolId=i.resourcePoolId,O.saveResourcePool=q,O.saveElement=D,O.saveElementCell=T,O.saveElementField=N,O.saveElementItem=$,O.ElementFieldDataType=c.ElementFieldDataType,O.ElementFieldIndexCalculationType=c.ElementFieldIndexCalculationType,O.ElementFieldIndexSortType=c.ElementFieldIndexSortType,d()}function t(e,t){e.cancel=function(){t.dismiss("cancel")},e.remove=function(){t.close()}}function n(e,t){function n(){e.getResourcePoolSet(!1).then(function(e){o.resourcePoolSet=e})}function r(){t.dismiss("cancel")}function l(e){t.close(e)}var o=this;o.close=r,o.copy=l,o.resourcePoolSet=[],n()}var r="ResourcePoolManageController";angular.module("main").controller(r,["resourcePoolFactory","userFactory","$location","$routeParams","$rootScope","$uibModal","Enums","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){u.editorConfig.isNew||e.getResourcePool(u.editorConfig.resourcePoolId).then(function(e){return null===e?void n.url("/_system/content/404"):void(l.viewTitle=e.name())})}function a(){var e=n.path().substring(n.path().lastIndexOf("/")+1),t="new"===e,l="edit"===e,o=r.resourcePoolId,i={isNew:t,isEdit:l,resourcePoolId:t?null:o};return i}o=o.forSource(t);var u=this;u.editorConfig=a(),i()}var t="ResourcePoolViewController";angular.module("main").controller(t,["resourcePoolFactory","$location","$routeParams","$rootScope","logger",e])}(),function(){"use strict";function e(e,n,r){function l(){o()}function o(){e.getResourcePoolExpanded(a.allInOneConfig.resourcePoolId).then(function(e){for(var t=0;t<e.ElementSet.length;t++)for(var n=e.ElementSet[t],r=0;r<n.ElementFieldSet.length;r++)for(var l=n.ElementFieldSet[r],o=0;o<l.ElementCellSet.length;o++){var i=l.ElementCellSet[o];if(i.currentUserCell())return void(e.userInteracted=!0)}})}function i(e,t){return t.ElementField.Element.ResourcePoolId===a.allInOneConfig.resourcePoolId?void(t.ElementField.Element.ResourcePool.userInteracted=!0):void 0}r=r.forSource(t);var a=this;a.allInOneConfig={resourcePoolId:7},n.$on("resourcePoolEditor_elementCellNumericValueIncreased",i),n.$on("resourcePoolEditor_elementCellNumericValueDecreased",i),n.$on("resourcePoolEditor_elementCellNumericValueReset",i),l()}var t="AllInOneController";angular.module("main").controller(t,["resourcePoolFactory","$scope","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){var t=-102,n=-103;e.getResourcePoolExpanded(t).then(function(e){null===e?a().then(function(e){e.Id=t,e.Name="Basics - Existing Model",e.UserResourcePoolSet[0].entityAspect.setDeleted(),e._init(!0),c.existingModelConfig.resourcePoolId=e.Id}):c.existingModelConfig.resourcePoolId=e.Id}),e.getResourcePoolExpanded(n).then(function(t){null===t?a().then(function(t){t.Id=n,t.Name="Basics - New Model";var l=e.createElementField({Element:t.mainElement(),Name:"Employee Satisfaction",DataType:4,UseFixedValue:!1,IndexEnabled:!0,IndexCalculationType:1,IndexSortType:1,SortOrder:2}),o=r.createEntity("User",{});l.ElementCellSet.forEach(function(e){var t={User:o,ElementCell:e,DecimalValue:Math.floor(100*Math.random()+1)};r.createEntity("UserElementCell",t)}),t._init(!0),c.newModelConfig.resourcePoolId=t.Id}):c.newModelConfig.resourcePoolId=t.Id})}function a(){return e.createResourcePoolDirectIncomeAndMultiplier().then(function(t){t.InitialValue=0,t.isTemp=!0;var n=t.mainElement();return n.Name="Organization",n.ElementItemSet[0].Name="Alpha",n.ElementItemSet[1].Name="Beta",e.createElementItem({Element:n,Name:"Charlie"}),e.createElementItem({Element:n,Name:"Delta"}),t})}function u(t,r){var l=0;r.ResourcePool.Id===c.existingModelConfig.resourcePoolId?l=c.newModelConfig.resourcePoolId:r.ResourcePool.Id===c.newModelConfig.resourcePoolId&&(l=c.existingModelConfig.resourcePoolId),0!==l&&e.getResourcePoolExpanded(l).then(function(e){switch(t.name){case"resourcePoolEditor_elementMultiplierIncreased":n.updateElementMultiplier(e.mainElement(),"increase");break;case"resourcePoolEditor_elementMultiplierDecreased":n.updateElementMultiplier(e.mainElement(),"decrease");break;case"resourcePoolEditor_elementMultiplierReset":n.updateElementMultiplier(e.mainElement(),"reset")}})}o=o.forSource(t);var c=this;c.existingModelConfig={},c.newModelConfig={},l.$on("resourcePoolEditor_elementMultiplierIncreased",u),l.$on("resourcePoolEditor_elementMultiplierDecreased",u),l.$on("resourcePoolEditor_elementMultiplierReset",u),i()}var t="BasicsController";angular.module("main").controller(t,["resourcePoolFactory","userFactory","dataContext","$scope","logger",e])}(),function(){"use strict";function e(e,n,r,l,o,i){function a(){s()}function u(){if(null===g){var e="To prevent losing your changes, you can register for free or if you have an existing account, please login first.",t="Save your changes?",n={extendedTimeOut:0,timeOut:0};g=i.logWarning(e,null,!0,t,n)}}function c(e,t){E.currentUser=t}function s(){e.getApplicationInfo().then(function(e){E.applicationInfo=e,E.applicationInfo.CurrentVersionText=E.applicationInfo.CurrentVersion+" - Alpha ~ Beta"})}function d(){n.logout().then(function(){l.url("/")})}function m(e,t,n){E.displayFooterIcons="/"===l.path(),"undefined"!=typeof t.enableDisqus&&t.enableDisqus?(E.disqusConfig.disqus_identifier=o+l.path().replace(/\//g,"_"),E.disqusConfig.disqus_url=l.absUrl().substring(0,l.absUrl().length-l.url().length+l.path().length)):E.disqusConfig.disqus_identifier="","/_system/account/register"!==l.path()&&"/_system/account/login"!==l.path()||null===g||g.remove()}function f(){E.displayBankTransfer=!E.displayBankTransfer}i=i.forSource(t);var g=null,E=this;E.applicationInfo=null,E.currentUser={Email:"",isAuthenticated:function(){return!1},hasPassword:function(){return!1}},E.currentDate=new Date,E.displayBankTransfer=!1,E.displayFooterIcons=!1,E.disqusConfig={disqus_shortname:o,disqus_identifier:"",disqus_url:""},E.logout=d,E.toggleBankTransfer=f,r.$on("$routeChangeSuccess",m),r.$on("anonymousUserInteracted",u),r.$on("userFactory_currentUserChanged",c),a()}var t="DefaultController";angular.module("main").controller(t,["applicationFactory","userFactory","$scope","$location","disqusShortname","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){var t=-101;e.getResourcePoolExpanded(t).then(function(o){function i(t){function o(){e.getResourcePoolExpanded(a.upoConfig.resourcePoolId).then(function(e){null!==e&&e.ElementSet.forEach(function(e){n.updateElementMultiplier(e,"increase")})}),i=l(o,2500)}a.upoConfig.resourcePoolId=t.Id;var i=l(o,5e3);r.$on("$destroy",function(e){l.cancel(i)})}null===o?e.createResourcePoolDirectIncomeAndMultiplier().then(function(n){n.Id=t,n.Name="Unidentified Profiting Object (UPO)",n.InitialValue=0,n.isTemp=!0,n.displayMultiplierFunctions=!1,n.UserResourcePoolSet[0].entityAspect.setDeleted();var r=n.mainElement();r.Name="Organization",r.ElementItemSet[0].Name="UPO",e.removeElementItem(r.ElementItemSet[1]),n._init(!0),i(n)}):i(o)})}o=o.forSource(t);var a=this;a.upoConfig={},i()}var t="IntroductionController";angular.module("main").controller(t,["resourcePoolFactory","userFactory","$scope","$timeout","logger",e])}(),function(){"use strict";function e(e,n,r,l,o){function i(){function e(){var n=Math.floor(4*Math.random());u.oldModelChartConfig.series[n].data[0]+=1,u.newModelChartConfig.series[0].data[0]+=1,t=l(e,1e3)}var t=l(e,1e4);r.$on("$destroy",function(e){l.cancel(t)})}function a(t,r){var l=7;r.ElementField.Element.ResourcePoolId===u.knowledgeIndexConfig.resourcePoolId&&e.getResourcePoolExpanded(l).then(function(l){if("undefined"==typeof l.userInteracted||!l.userInteracted)for(var o=0;o<l.ElementSet.length;o++){var i=l.ElementSet[o];if(i.Name===r.ElementField.Element.Name)for(var a=0;a<i.ElementFieldSet.length;a++){var u=i.ElementFieldSet[a];if(u.Name===r.ElementField.Name)for(var c=0;c<u.ElementCellSet.length;c++){var s=u.ElementCellSet[c];if(s.ElementItem.Name===r.ElementItem.Name){switch(t.name){case"resourcePoolEditor_elementCellNumericValueIncreased":n.updateElementCellNumericValue(s,"increase");break;case"resourcePoolEditor_elementCellNumericValueDecreased":n.updateElementCellNumericValue(s,"decrease");break;case"resourcePoolEditor_elementCellNumericValueReset":n.updateElementCellNumericValue(s,"reset")}e.saveChanges(1500);break}}}}})}o=o.forSource(t);var u=this;u.oldModelChartConfig={title:{text:""},options:{chart:{type:"column",height:358},plotOptions:{column:{allowPointSelect:!0,pointWidth:15}},xAxis:{categories:["Knowledge"]},yAxis:{title:{text:"Development process"},allowDecimals:!1,min:0}},size:{},series:[{name:"My Precious Jewelry",data:[0]},{name:"Death Star Architecture",data:[0]},{name:"Christina's Secret",data:[0]},{name:"Nuka Cola Company",data:[0]}]},u.newModelChartConfig={title:{text:""},options:{chart:{type:"column",height:300},plotOptions:{column:{allowPointSelect:!0,pointWidth:15}},xAxis:{categories:["Knowledge"]},yAxis:{title:{text:"Development process"},allowDecimals:!1,min:0}},size:{},series:[{name:"Global Knowledge Database",data:[0]}]},u.knowledgeIndexConfig={resourcePoolId:3},r.$on("resourcePoolEditor_elementCellNumericValueIncreased",a),r.$on("resourcePoolEditor_elementCellNumericValueDecreased",a),r.$on("resourcePoolEditor_elementCellNumericValueReset",a),i()}var t="KnowledgeIndexController";angular.module("main").controller(t,["resourcePoolFactory","userFactory","$scope","$timeout","logger",e])}(),function(){"use strict";function e(e,n,r,l){function o(t,r){var l=7;r.ElementField.Element.ResourcePoolId===i.priorityIndexConfig.resourcePoolId&&e.getResourcePoolExpanded(l).then(function(l){if("undefined"==typeof l.userInteracted||!l.userInteracted)for(var o=0;o<l.ElementSet.length;o++){var i=l.ElementSet[o];if(i.Name===r.ElementField.Element.Name)for(var a=0;a<i.ElementFieldSet.length;a++){var u=i.ElementFieldSet[a];if(u.Name===r.ElementField.Name)for(var c=0;c<u.ElementCellSet.length;c++){var s=u.ElementCellSet[c];if(s.ElementItem.Name===r.ElementItem.Name){switch(t.name){case"resourcePoolEditor_elementCellNumericValueIncreased":n.updateElementCellNumericValue(s,"increase");break;case"resourcePoolEditor_elementCellNumericValueDecreased":n.updateElementCellNumericValue(s,"decrease");break;case"resourcePoolEditor_elementCellNumericValueReset":n.updateElementCellNumericValue(s,"reset")}e.saveChanges(1500);break}}}}})}l=l.forSource(t);var i=this;i.priorityIndexConfig={resourcePoolId:2},r.$on("resourcePoolEditor_elementCellNumericValueIncreased",o),r.$on("resourcePoolEditor_elementCellNumericValueDecreased",o),r.$on("resourcePoolEditor_elementCellNumericValueReset",o)}var t="PriorityIndexController";angular.module("main").controller(t,["resourcePoolFactory","userFactory","$scope","logger",e])}(),function(){"use strict";function e(e,n,r,l){function o(t,r){var l=0;r.ResourcePool.Id===i.existingModelConfig.resourcePoolId?l=i.newModelConfig.resourcePoolId:r.ResourcePool.Id===i.newModelConfig.resourcePoolId&&(l=i.existingModelConfig.resourcePoolId),l>0&&e.getResourcePoolExpanded(l).then(function(r){switch(t.name){case"resourcePoolEditor_elementMultiplierIncreased":n.updateElementMultiplier(r.mainElement(),"increase");break;case"resourcePoolEditor_elementMultiplierDecreased":n.updateElementMultiplier(r.mainElement(),"decrease");break;case"resourcePoolEditor_elementMultiplierReset":n.updateElementMultiplier(r.mainElement(),"reset")}e.saveChanges(1500)})}l=l.forSource(t);var i=this;i.existingModelConfig={resourcePoolId:5},i.newModelConfig={resourcePoolId:6},r.$on("resourcePoolEditor_elementMultiplierIncreased",o),r.$on("resourcePoolEditor_elementMultiplierDecreased",o),r.$on("resourcePoolEditor_elementMultiplierReset",o)}var t="TotalCostIndexController";angular.module("main").controller(t,["resourcePoolFactory","userFactory","$scope","logger",e])}(),function(){"use strict";function e(e,n,r,l,o,i){function a(t,r,i){function a(e){t.resourcePool.selectedElement(e),v()}function u(){var e="undefined"==typeof t.config.resourcePoolId?null:Number(t.config.resourcePoolId);n.getCurrentUser().then(function(t){P(t,e)})}function c(e){n.updateElementCellNumericValue(e,"decrease"),o.$broadcast("resourcePoolEditor_elementCellNumericValueDecreased",e),U()}function s(e){n.updateElementMultiplier(e,"decrease"),o.$broadcast("resourcePoolEditor_elementMultiplierDecreased",e),U()}function d(e){n.updateElementCellMultiplier(e,"decrease"),o.$broadcast("resourcePoolEditor_elementCellMultiplierDecreased",element),U()}function m(e){n.updateElementFieldIndexRating(e,"decrease"),U()}function f(){n.updateResourcePoolRate(t.resourcePool,"decrease"),U()}function g(){l.url("/_system/resourcePool/"+t.resourcePoolId+"/edit")}function E(e){o.$broadcast("resourcePoolEditor_elementCellNumericValueIncreased",e),n.updateElementCellNumericValue(e,"increase"),U()}function h(e){n.updateElementMultiplier(e,"increase"),o.$broadcast("resourcePoolEditor_elementMultiplierIncreased",e),U()}function p(e){n.updateElementCellMultiplier(e,"increase"),o.$broadcast("resourcePoolEditor_elementCellMultiplierIncreased",element),U()}function y(e){n.updateElementFieldIndexRating(e,"increase"),U()}function R(){n.updateResourcePoolRate(t.resourcePool,"increase"),U()}function P(n,r){if(t.currentUser!==n||t.resourcePoolId!==r){if(t.currentUser=n,t.resourcePoolId=r,t.errorMessage="",t.chartConfig={credits:{enabled:!1},loading:!0,options:{plotOptions:{column:{allowPointSelect:!0,pointWidth:15},pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},tooltip:{headerFormat:""},xAxis:{categories:[""]},yAxis:{allowDecimals:!1,min:0}},size:{},title:{text:""}},null===t.resourcePoolId)return t.errorMessage="CMRP Id cannot be null",void(t.chartConfig.loading=!1);e.getResourcePoolExpanded(t.resourcePoolId).then(function(e){return null===e?void(t.errorMessage="Invalid CMRP Id"):(t.resourcePool=e,void(null!==t.resourcePool.selectedElement()&&v()))})["catch"](function(){})["finally"](function(){t.chartConfig.loading=!1})}}function v(){var e=t.resourcePool.selectedElement(),n=null;null!==e&&(e.ElementItemSet.length>20||(t.chartConfig.title={text:e.Name},t.chartConfig.series=[],t.displayIndexDetails?(t.chartConfig.title={text:"Indexes"},t.chartConfig.options.chart={type:"pie"},t.chartConfig.options.yAxis.title={text:""},n=[],e.elementFieldIndexSet().forEach(function(e){var t=new w(e);n.push(t)}),t.chartConfig.series=[{data:n}]):(t.chartConfig.title={text:e.Name},e===e.ResourcePool.mainElement()&&(e.totalIncome()>0||null!==e.directIncomeField())?(t.chartConfig.options.chart={type:"column"},t.chartConfig.options.yAxis.title={text:"Total Income"},e.ElementItemSet.forEach(function(e){var n=new V(e);t.chartConfig.series.push(n)})):(t.chartConfig.options.chart={type:"pie"},t.chartConfig.options.yAxis.title={text:""},n=[],e.ElementItemSet.forEach(function(e){e.ElementCellSet.forEach(function(e){if(e.ElementField.IndexEnabled){var t=new A(e);n.push(t)}})}),t.chartConfig.series=[{data:n}]))))}function C(e){n.updateElementCellNumericValue(e,"reset"),o.$broadcast("resourcePoolEditor_elementCellNumericValueReset",element),U()}function F(e){n.updateElementMultiplier(e,"reset"),o.$broadcast("resourcePoolEditor_elementMultiplierReset",e),U()}function I(e){n.updateElementCellMultiplier(e,"reset"),o.$broadcast("resourcePoolEditor_elementCellMultiplierReset",element),U()}function S(e){n.updateElementFieldIndexRating(e,"reset"),U()}function b(){n.updateResourcePoolRate(t.resourcePool,"reset"),U()}function U(){e.saveChanges(1500)["catch"](function(e){"undefined"!=typeof e.status&&"409"===e.status||"undefined"!=typeof e.entityErrors})}function _(){t.isSaving=!0}function x(){t.isSaving=!1}function k(){t.displayIndexDetails=!t.displayIndexDetails,v()}function M(e,n){P(n,t.resourcePoolId)}function V(e){var t=this;Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,get:function(){return e.Name}}),Object.defineProperty(t,"data",{enumerable:!0,configurable:!0,get:function(){return[e.totalIncome()]}})}function w(e){var t=this;Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,get:function(){return e.Name}}),Object.defineProperty(t,"y",{enumerable:!0,configurable:!0,get:function(){var t=e.indexRating();return Number(t.toFixed(2))}})}function A(e){var t=this;Object.defineProperty(t,"name",{enumerable:!0,configurable:!0,get:function(){return e.ElementItem.Name}}),Object.defineProperty(t,"y",{enumerable:!0,configurable:!0,get:function(){var t=e.numericValue();return Number(t.toFixed(2))}})}t.currentUser=null,t.displayIndexDetails=!1,t.editResourcePool=g,t.errorMessage="",t.isSaving=!1,t.resourcePool={Name:"Loading..."},t.resourcePoolId=null,t.changeSelectedElement=a,t.decreaseElementCellNumericValue=c,t.decreaseElementMultiplier=s,t.decreaseElementCellMultiplier=d,t.decreaseIndexRating=m,t.decreaseResourcePoolRate=f,t.increaseElementCellNumericValue=E,t.increaseElementMultiplier=h,t.increaseElementCellMultiplier=p,t.increaseIndexRating=y,t.increaseResourcePoolRate=R,t.resetElementCellNumericValue=C,
t.resetElementMultiplier=F,t.resetElementCellMultiplier=I,t.resetIndexRating=S,t.resetResourcePoolRate=b,t.toggleIndexDetails=k,t.$watch("config",u,!0),t.$on("saveChangesStart",_),t.$on("saveChangesCompleted",x),t.$on("userFactory_currentUserChanged",M)}return i=i.forSource(t),{restrict:"E",templateUrl:"/_system/js/app/directives/resourcePoolEditor/resourcePoolEditor.html?v=0.49.0",scope:{config:"="},link:a}}var t="resourcePoolEditor";angular.module("main").directive(t,["resourcePoolFactory","userFactory","Enums","$location","$rootScope","logger",e])}(),function(){"use strict";function e(e,n,r){function l(t){return e.createEntity("ResourcePool",t)}function o(e){e.entityAspect.setDeleted()}function i(){return e.getChanges()}function a(){return e.getChangesCount()}function u(t){function n(e){o=e.results.length;var t=[];return e.results.forEach(function(e){e.isTemp||t.push(e)}),t}function l(e){var t=e.message||"ResourcePool query failed";r.logError(t,e,!0)}var o;t&&e.hasChanges()&&(o=e.getChangesCount(),e.rejectChanges(),r.logWarning("Discarded "+o+" pending change(s)",null));var i=breeze.EntityQuery.from("ResourcePool").expand(["User"]),a=E===g||t;return a?(i=i.using(breeze.FetchStrategy.FromServer),E=new Date):i=i.using(breeze.FetchStrategy.FromLocalCache),e.executeQuery(i).then(n)["catch"](l)}function c(t,n){function l(e){return e.entity}function o(e){var t=e.message||"getResourcePool query failed";r.logError(t,e,!0)}return e.fetchEntityByKey("ResourcePool",t,!n).then(l)["catch"](o)}function s(){return e.hasChanges()}function d(){e.rejectChanges()}function m(t){return e.saveChanges(t)}function f(t,n){return e.saveChangesAlt(t.getEntities(),n)}r=r.forSource(t);var g=new Date(0),E=g,h={createResourcePool:l,deleteResourcePool:o,getChanges:i,getChangesCount:a,getResourcePoolSet:u,getResourcePool:c,hasChanges:s,rejectChanges:d,saveChanges:m,saveChangesAlt:f};return n.$on("userFactory_currentUserChanged",function(){E=g}),h}var t="resourcePoolFactory";angular.module("main").factory(t,["dataContext","$rootScope","logger",e])}(),function(){"use strict";function e(e,n,r){function l(t){return e.createEntity("Users",t)}function o(e){e.entityAspect.setDeleted()}function i(){return e.getChanges()}function a(){return e.getChangesCount()}function u(t){function n(e){return o=e.results.length,e.results}function l(e){var t=e.message||"User query failed";r.logError(t,e,!0)}var o;t&&e.hasChanges()&&(o=e.getChangesCount(),e.rejectChanges(),r.logWarning("Discarded "+o+" pending change(s)",null));var i=breeze.EntityQuery.from("Users"),a=E===g||t;return a?(i=i.using(breeze.FetchStrategy.FromServer),E=new Date):i=i.using(breeze.FetchStrategy.FromLocalCache),e.executeQuery(i).then(n)["catch"](l)}function c(t,n){function l(e){return e.entity}function o(e){var t=e.message||"getUser query failed";r.logError(t,e,!0)}return e.fetchEntityByKey("User",t,!n).then(l)["catch"](o)}function s(){return e.hasChanges()}function d(){e.rejectChanges()}function m(t){return e.saveChanges(t)}function f(t,n){var r=[t];return e.saveChangesAlt(r,n)}r=r.forSource(t);var g=new Date(0),E=g,h={createUser:l,deleteUser:o,getChanges:i,getChangesCount:a,getUserSet:u,getUser:c,hasChanges:s,rejectChanges:d,saveChanges:m,saveChangesAlt:f};return n.$on("userFactory_currentUserChanged",function(){E=g}),h}var t="userFactory";angular.module("main").factory(t,["dataContext","$rootScope","logger",e])}(),function(){"use strict";function e(e,n){n=n.forSource(t)}var t="FairShareIndexSampleController";angular.module("main").controller(t,["userFactory","logger",e])}(),function(){"use strict";function e(e){e=e.forSource(t);var n=this;n.resourcePoolRate_SampleResourcePoolId=12}var t="ResourcePoolRateSampleController";angular.module("main").controller(t,["logger",e])}();
//# sourceMappingURL=app.min.js.map
